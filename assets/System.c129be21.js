import{c as re,u as P,r as b,bE as ye,dQ as je,dP as ge,bG as ce,j as e,bR as ve,bS as fe,bT as we,bs as U,bV as Ce,b3 as be,b4 as _e,b5 as D,bM as F,G as ke,dR as Ne,dS as Pe,dT as $,L as i,b as w,I as h,bL as M,bh as E,a5 as j,dU as Te,aL as V,bZ as Se,O as C,dV as Me,bW as de,dW as Ae,dH as v,dC as Q,dI as J,dJ as X,dF as Z,dG as q,e as le,bO as R,a3 as Y,a4 as ee,a6 as se,a7 as ae,dX as te,as as oe,a9 as ne,dY as Ie,a as Le,s as ze,bk as G,ac as Ee,dZ as Re,bN as me,dl as De,cP as $e,d0 as H,d_ as Ve,d$ as We,e0 as A,e1 as Be,e2 as Fe,e3 as qe,e4 as Oe}from"./index.59694a49.js";import{P as T,b as _,a as r,d as S,c as W}from"./Paragraph.e7cb6a63.js";import{A as Ke,a as Ge,b as He,c as Ue}from"./accordion.31111ca3.js";import{a as ie}from"./groups.c24f8e23.js";import{a as ue}from"./hook.891b1d97.js";import{T as he,a as xe,b as O,c as L,d as pe,e as z}from"./table.ca326b4a.js";import{a as Qe,b as Je}from"./icons.58236968.js";import{C as Xe}from"./credit-card.d752b3f7.js";import{U as Ze}from"./upload.97938176.js";import{U as Ye}from"./users-round.726b9065.js";import{C as es}from"./circle-plus.805285b4.js";import"./funnel.1dc762bc.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M22 14a8 8 0 0 1-8 8",key:"56vcr3"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1agjmk"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1",key:"wdbh2u"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10",key:"1ibuk9"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"g6ys72"}]],as=re("Pointer",ss);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]],ns=re("SlidersVertical",ts);function ls(){const{t:a}=P(),[t,c]=b.useState(!1),[s,l]=b.useState(""),[m,u]=b.useState(""),d=async()=>{const p=await Oe(s);V(a,p,!0),p.status&&(l(""),u(""),c(!1),setTimeout(()=>{window.location.reload()},1e3))};return e.jsxs(Y,{open:t,onOpenChange:c,children:[e.jsx(ee,{asChild:!0,children:e.jsx(j,{variant:"outline",size:"sm",children:a("admin.system.updateRoot")})}),e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:a("admin.system.updateRoot")}),e.jsxs(oe,{children:[e.jsx("div",{className:"mb-4 select-none",children:a("admin.system.updateRootTip")}),e.jsx(h,{className:"mb-2",type:"password",placeholder:a("admin.system.updateRootPlaceholder"),value:s,onChange:p=>l(p.target.value)}),e.jsx(h,{type:"password",placeholder:a("admin.system.updateRootRepeatPlaceholder"),value:m,onChange:p=>u(p.target.value)})]})]}),e.jsxs(ne,{children:[e.jsx(j,{unClickable:!0,variant:"outline",onClick:()=>{l(""),u(""),c(!1)},children:a("admin.cancel")}),e.jsx(j,{unClickable:!0,variant:"default",loading:!0,onClick:d,disabled:s.trim().length===0||s.trim()!==m.trim(),children:a("admin.confirm")})]})]})]})}function is({data:a,dispatch:t,onChange:c}){var m,u,d,p,y,x;const{t:s}=P(),l=b.useRef(null);return e.jsxs(T,{title:s("admin.system.general"),configParagraph:!0,isCollapsed:!0,children:[e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.title")}),e.jsx(h,{value:a.title,onChange:n=>t({type:"update:general.title",value:n.target.value}),placeholder:s("admin.system.titleTip")})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.docs")}),e.jsx(h,{value:a.docs,onChange:n=>t({type:"update:general.docs",value:n.target.value}),placeholder:s("admin.system.docsTip")})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.keyDocs")}),e.jsx(h,{value:a.key_docs||"",onChange:n=>t({type:"update:general.key_docs",value:n.target.value}),placeholder:s("admin.system.keyDocsTip")})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.logo")}),e.jsx(h,{value:a.logo,onChange:n=>t({type:"update:general.logo",value:n.target.value}),placeholder:s("admin.system.logoTip",{logo:`${window.location.protocol}//${window.location.host}/favicon.ico`}),className:"!mr-2"}),e.jsx("input",{type:"file",id:"logo-uploader",ref:l,className:"hidden",onChange:async n=>{var o;const g=(o=n.target.files)==null?void 0:o[0];if(!g)return;const N=await Te(g);V(s,N,!0,s("admin.system.uploadFaviconSuccess")),N.status&&N.url&&t({type:"update:general.logo",value:Se+N.url}),n.target.value=""}}),e.jsx(j,{variant:"outline",size:"icon",className:"shrink-0",onClick:()=>{var n;return(n=l.current)==null?void 0:n.click()},children:e.jsx(Ze,{className:"h-4 w-4"})})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.description")}),e.jsx(E,{value:a.description,rows:6,onChange:n=>t({type:"update:general.description",value:n.target.value}),placeholder:s("admin.system.descriptionTip")})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.backend")}),e.jsx(h,{value:a.backend,onChange:n=>t({type:"update:general.backend",value:n.target.value}),placeholder:s("admin.system.backendPlaceholder")})]}),e.jsx(_,{border:!0,children:s("admin.system.realtime.title")}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.realtime.wsBufferSize"),e.jsx(C,{content:s("admin.system.realtime.wsBufferSizeTip")})]}),e.jsx(M,{value:((u=(m=a.realtime)==null?void 0:m.ws)==null?void 0:u.buffer_size)??1,onValueChange:n=>t({type:"update:general.realtime.ws.buffer_size",value:n}),min:1})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.realtime.wsAggregate"),e.jsx(C,{content:s("admin.system.realtime.wsAggregateTip")})]}),e.jsx(w,{checked:!!((p=(d=a.realtime)==null?void 0:d.ws)!=null&&p.aggregate),onCheckedChange:n=>t({type:"update:general.realtime.ws.aggregate",value:n})})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.realtime.wsAggregateWindow"),e.jsx(C,{content:s("admin.system.realtime.wsAggregateWindowTip")})]}),e.jsx(M,{value:((x=(y=a.realtime)==null?void 0:y.ws)==null?void 0:x.aggregate_window_ms)??20,onValueChange:n=>t({type:"update:general.realtime.ws.aggregate_window_ms",value:n}),min:1})]}),e.jsx(_,{border:!0,children:s("admin.system.backendTip",{backend:`${window.location.protocol}//${window.location.host}/api`})}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.file")}),e.jsx(h,{value:a.file,onChange:n=>t({type:"update:general.file",value:n.target.value}),placeholder:s("admin.system.filePlaceholder")})]}),e.jsx(_,{border:!0,children:s("admin.system.fileTip")}),e.jsxs(r,{children:[e.jsx(i,{children:"PWA Manifest"}),e.jsx(Me,{value:a.pwa_manifest??"",onChange:n=>t({type:"update:general.pwa_manifest",value:n}),children:e.jsxs(j,{classNameWrapper:"ml-auto",variant:"outline",children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),s("edit")]})})]}),e.jsxs(r,{children:[e.jsx(i,{children:"Gravatar"}),e.jsx(h,{value:a.gravatar,onChange:n=>t({type:"update:general.gravatar",value:n.target.value}),placeholder:s("admin.system.gravatarPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[s("admin.system.debugMode"),e.jsx(C,{className:"inline-block",content:s("admin.system.debugModeTip")})]}),e.jsx(w,{checked:a.debug_mode,onCheckedChange:n=>{t({type:"update:general.debug_mode",value:n})}})]}),e.jsx(W,{}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(ls,{}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function rs({form:a,dispatch:t,onChange:c}){var d;const{t:s}=P(),l=[5,10,20,50,100,500,1e3],m=l.length,u=Array.from({length:m},(p,y)=>{var n;const x=(n=a.site.builtin_amounts)==null?void 0:n[y];return typeof x=="number"&&x>0?Math.floor(x):l[y]});return e.jsxs(T,{title:s("admin.system.orderAmount"),configParagraph:!0,isCollapsed:!0,isPro:!0,children:[e.jsx(_,{border:!0,hideIcon:!0,children:s("admin.system.order-amount-tip")}),e.jsx(r,{children:e.jsxs(he,{classNameArea:"w-full",children:[e.jsx(xe,{children:e.jsxs(O,{children:[e.jsx(L,{children:"#"}),e.jsx(L,{children:s("admin.system.default")}),e.jsx(L,{children:s("admin.system.amount")})]})}),e.jsx(pe,{children:u.map((p,y)=>e.jsxs(O,{children:[e.jsx(z,{children:y+1}),e.jsx(z,{children:l[y]}),e.jsx(z,{className:"w-[200px]",children:e.jsx(M,{value:p,onValueChange:x=>{const n=Array.from({length:m},(o,k)=>{var f;const I=(f=a.site.builtin_amounts)==null?void 0:f[k];return typeof I=="number"&&I>0?Math.floor(I):l[k]}),g=Number(x);n[y]=g&&g>0?Math.floor(g):l[y];const N=n.slice(0,m);t({type:"update:site.builtin_amounts",value:N})},min:1})})]},`builtin-${y}`))})]})}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.minRechargeQuotaLabel"),e.jsx(C,{content:s("admin.system.minRechargeQuotaTip")})]}),e.jsx(M,{value:((d=a.payment)==null?void 0:d.min_recharge_quota)??0,onValueChange:p=>t({type:"update:payment.min_recharge_quota",value:p}),min:0})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}const B=({data:a,dispatch:t,id:c,params:s})=>{const{t:l}=P(),m=b.useMemo(()=>a.providers[c],[a,c]);return e.jsxs(Ge,{value:c,children:[e.jsx(He,{children:l(`admin.system.oauth.${c}`)}),e.jsx(Ue,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"mb-1.5 font-semibold",children:l("admin.system.oauth.enable")}),e.jsx(w,{className:"!ml-0",checked:m.enabled,onCheckedChange:u=>{t({type:`update:oauth.providers.${c}.enabled`,value:u})}})]}),c==="rainbow"&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"mb-1.5 font-semibold",children:l("admin.system.oauth.require_email")}),e.jsx(w,{className:"!ml-0",checked:a.providers.rainbow.require_email,onCheckedChange:u=>{t({type:"update:oauth.providers.rainbow.require_email",value:u})}})]}),s.map(u=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx(i,{className:"mb-1.5 font-medium",children:l(`admin.system.oauth.${u}`)}),u==="redirect_uri"?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(j,{className:"shrink-0 whitespace-nowrap mr-1.5",onClick:()=>{t({type:`update:oauth.providers.${c}.${u}`,value:`${window.location.origin}/auth/${c}`})},children:[e.jsx(as,{className:"h-4 w-4 mr-1.5"}),l("get")]}),e.jsx(h,{value:m[u],onChange:d=>t({type:`update:oauth.providers.${c}.${u}`,value:d.target.value}),placeholder:l(`admin.system.oauth.${u}_placeholder`)})]}):e.jsx(h,{value:m[u],onChange:d=>t({type:`update:oauth.providers.${c}.${u}`,value:d.target.value}),placeholder:l(`admin.system.oauth.${u}_placeholder`)})]},u))]})})]})};function cs({data:a,dispatch:t,onChange:c}){const{t:s}=P();return e.jsxs(T,{title:s("admin.system.oauth.title"),configParagraph:!0,isCollapsed:!0,children:[e.jsxs(Ke,{type:"multiple",className:"w-full",children:[e.jsx(B,{data:a,dispatch:t,id:"wechat",params:["client_id","client_secret","redirect_uri"]}),e.jsx(B,{data:a,dispatch:t,id:"google",params:["client_id","client_secret","redirect_uri"]}),e.jsx(B,{data:a,dispatch:t,id:"github",params:["client_id","client_secret","redirect_uri"]}),e.jsx(B,{data:a,dispatch:t,id:"telegram",params:["bot_token","bot_name","redirect_uri"]}),e.jsx(B,{data:a,dispatch:t,id:"rainbow",params:["base_url","methods","client_id","client_secret","redirect_uri"]})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function ds({data:a,dispatch:t,onChange:c}){const{t:s}=P(),[l,m]=b.useState(""),[u,d]=b.useState(!1),p=b.useMemo(()=>a.host.length>0&&a.port>0&&a.port<65535&&a.username.length>0&&a.password.length>0&&a.from.length>0,[a]),y=async()=>{if(!l.trim())return;await c(!1);const n=await Fe(l);V(s,n,!0),n.status&&d(!1)},x=b.useMemo(()=>{const n=a.white_list.custom.split(",").map(g=>g.trim()).filter(g=>g.length>0);return[...Ae,...n]},[a]);return e.jsxs(T,{title:s("admin.system.mail"),configParagraph:!0,isCollapsed:!0,children:[!p&&e.jsx(_,{border:!0,children:s("admin.system.mailConfNotValid")}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.mailHost")]}),e.jsx(h,{value:a.host,onChange:n=>t({type:"update:mail.host",value:n.target.value}),placeholder:"smtp.qcloudmail.com"})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.mailProtocol")]}),e.jsxs(Q,{value:a.protocol?"true":"false",onValueChange:n=>{t({type:"update:mail.protocol",value:n==="true"})},children:[e.jsx(J,{className:"select",children:e.jsx(X,{placeholder:a.protocol?s("admin.system.mailProtocolTLS"):s("admin.system.mailProtocolSSL")})}),e.jsxs(Z,{children:[e.jsx(q,{value:"true",children:"TLS"}),e.jsx(q,{value:"false",children:"SSL"})]})]})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.mailPort")]}),e.jsx(M,{value:a.port,onValueChange:n=>t({type:"update:mail.port",value:n}),placeholder:"465",min:0,max:65535})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.mailUser")]}),e.jsx(h,{value:a.username,onChange:n=>t({type:"update:mail.username",value:n.target.value}),className:le("transition-all duration-300"),placeholder:s("admin.system.mailUser")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.mailPass")]}),e.jsx(h,{value:a.password,onChange:n=>t({type:"update:mail.password",value:n.target.value}),placeholder:s("admin.system.mailPass")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.mailFrom")]}),e.jsx(h,{value:a.from,onChange:n=>t({type:"update:mail.from",value:n.target.value}),placeholder:`${s("admin.system.mailFrom")} <${a.username}@${location.hostname}>`,className:le("transition-all duration-300")})]}),e.jsx(W,{}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.mailEnableWhitelist")}),e.jsx(w,{checked:a.white_list.enabled,onCheckedChange:n=>{t({type:"update:mail.white_list.enabled",value:n})}})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.mailWhitelist")}),e.jsx(R,{value:a.white_list.white_list,list:x,disabled:!a.white_list.enabled,onChange:n=>{t({type:"update:mail.white_list.white_list",value:n})},placeholder:s("admin.system.mailWhitelistSelected",{length:a.white_list.white_list.length}),searchPlaceholder:s("admin.system.mailWhitelistSearchPlaceholder")})]}),e.jsx(h,{className:"mb-2",value:a.white_list.custom,onChange:n=>t({type:"update:mail.white_list.custom",value:n.target.value}),disabled:!a.white_list.enabled,placeholder:s("admin.system.customWhitelistPlaceholder")}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsxs(Y,{open:u,onOpenChange:d,children:[e.jsx(ee,{asChild:!0,children:e.jsx(j,{variant:"outline",size:"sm",children:s("admin.system.test")})}),e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:s("admin.system.test")}),e.jsx(oe,{className:"pt-2",children:e.jsx(h,{placeholder:s("auth.email-placeholder"),value:l,onChange:n=>m(n.target.value)})})]}),e.jsxs(ne,{children:[e.jsx(j,{unClickable:!0,variant:"outline",onClick:()=>{m(""),d(!1)},children:s("admin.cancel")}),e.jsx(j,{unClickable:!0,variant:"default",loading:!0,onClick:y,children:s("admin.confirm")})]})]})]}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function os({data:a,dispatch:t,onChange:c}){const{t:s}=P();return e.jsxs(T,{title:s("admin.system.site"),configParagraph:!0,isCollapsed:!0,children:[e.jsxs(r,{children:[e.jsxs(i,{children:[s("admin.system.displayCurrency"),e.jsx(C,{className:"inline-block",content:s("admin.system.displayCurrencyTip")})]}),e.jsxs(Q,{value:a.currency,onValueChange:l=>{t({type:"update:site.currency",value:l})},children:[e.jsx(J,{className:"w-[180px]",children:e.jsx(X,{placeholder:s("admin.system.selectCurrency")})}),e.jsx(Z,{children:Object.entries(Ie).map(([l,m])=>e.jsxs(q,{value:l,children:[m.name," (",m.symbol,")"]},l))})]})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[s("admin.system.closeRegistration"),e.jsx(C,{className:"inline-block",content:s("admin.system.closeRegistrationTip")})]}),e.jsx(w,{checked:a.close_register,onCheckedChange:l=>{t({type:"update:site.close_register",value:l})}})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[s("admin.system.closeRelay"),e.jsx(C,{className:"inline-block",content:s("admin.system.closeRelayTip")})]}),e.jsx(w,{checked:a.close_relay,onCheckedChange:l=>{t({type:"update:site.close_relay",value:l})}})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[s("admin.system.relayPlan"),e.jsx(C,{className:"inline-block",content:s("admin.system.relayPlanTip")})]}),e.jsx(w,{checked:a.relay_plan,onCheckedChange:l=>{t({type:"update:site.relay_plan",value:l})}})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.preDeductQuota"),e.jsx(C,{content:s("admin.system.preDeductQuotaTip")})]}),e.jsx(w,{checked:a.pre_deduct_quota,onCheckedChange:l=>{t({type:"update:site.pre_deduct_quota",value:l})}})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.quota"),e.jsx(C,{content:s("admin.system.quotaTip")})]}),e.jsx(M,{value:a.quota,onValueChange:l=>t({type:"update:site.quota",value:l}),placeholder:"5",min:0})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.buyLink")}),e.jsx(h,{value:a.buy_link,onChange:l=>t({type:"update:site.buy_link",value:l.target.value}),placeholder:s("admin.system.buyLinkPlaceholder")})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.announcement")}),e.jsx(E,{value:a.announcement,rows:12,onChange:l=>t({type:"update:site.announcement",value:l.target.value}),placeholder:s("admin.system.announcementPlaceholder")})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.contact")}),e.jsx(E,{value:a.contact,rows:6,onChange:l=>t({type:"update:site.contact",value:l.target.value}),placeholder:s("admin.system.contactPlaceholder")})]}),e.jsx(W,{}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.footer")}),e.jsx(E,{rows:6,value:a.footer,onChange:l=>t({type:"update:site.footer",value:l.target.value}),placeholder:s("admin.system.footerPlaceholder")})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.authFooter")}),e.jsx(w,{checked:a.auth_footer,onCheckedChange:l=>{t({type:"update:site.auth_footer",value:l})}})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.hideKeyDocs")}),e.jsx(w,{checked:a.hide_key_docs,onCheckedChange:l=>{t({type:"update:site.hide_key_docs",value:l})}})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function ms({form:a,data:t,dispatch:c,onChange:s}){const{t:l}=P(),{channelModels:m}=ue(),u=Le(ze);return e.jsxs(T,{title:l("admin.system.common"),configParagraph:!0,isCollapsed:!0,children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[l("admin.system.prompt_store"),e.jsx(C,{content:l("admin.system.prompt_storeTip")})]}),e.jsx(w,{checked:t.prompt_store,onCheckedChange:d=>{c({type:"update:common.prompt_store",value:d})}})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[l("admin.system.image_store"),e.jsx(C,{content:l("admin.system.image_storeTip")})]}),e.jsx(w,{checked:t.image_store,onCheckedChange:d=>{c({type:"update:common.image_store",value:d})}})]}),t.image_store&&a.general.backend.length===0&&e.jsx(_,{border:!0,children:l("admin.system.image_storeNoBackend")}),e.jsx(W,{}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[l("admin.system.cache"),e.jsx(C,{content:l("admin.system.cacheTip")})]}),e.jsx(R,{value:t.cache,onChange:d=>{c({type:"update:common.cache",value:d})},list:m,placeholder:l("admin.system.cachePlaceholder",{length:(t.cache??[]).length})})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[l("admin.system.cacheExpired"),e.jsx(C,{className:"inline-block",content:l("admin.system.cacheExpiredTip")})]}),e.jsx(M,{value:t.expire,onValueChange:d=>c({type:"update:common.expire",value:d}),min:0})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[l("admin.system.cacheSize"),e.jsx(C,{className:"inline-block",content:l("admin.system.cacheSizeTip")})]}),e.jsx(M,{value:t.size,onValueChange:d=>c({type:"update:common.size",value:d}),min:0})]}),e.jsx(r,{children:e.jsxs("div",{className:"flex flex-row flex-wrap gap-2 ml-auto",children:[e.jsxs(j,{variant:"outline",onClick:()=>c({type:"update:common.cache",value:[]}),children:[e.jsx(F,{className:"inline-flex h-4 w-4 mr-2 translate-y-[1px]"}),l("admin.system.cacheNone")]}),e.jsxs(j,{variant:"outline",onClick:()=>c({type:"update:common.cache",value:u.filter(d=>d.free).map(d=>d.id)}),children:[e.jsx(F,{className:"inline-flex h-4 w-4 mr-2 translate-y-[1px]"}),l("admin.system.cacheFree")]}),e.jsxs(j,{variant:"outline",onClick:()=>c({type:"update:common.cache",value:m}),children:[e.jsx(F,{className:"inline-flex h-4 w-4 mr-2 translate-y-[1px]"}),l("admin.system.cacheAll")]})]})}),e.jsx(W,{}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[l("admin.system.article"),e.jsx(C,{content:l("admin.system.articleTip")})]}),e.jsx(R,{value:t.article,onChange:d=>{c({type:"update:common.article",value:d})},list:ie,listTranslate:"admin.channels.groups",placeholder:l("admin.system.groupPlaceholder",{length:(t.article??[]).length})})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[l("admin.system.generate"),e.jsx(C,{content:l("admin.system.generateTip")})]}),e.jsx(R,{value:t.generation,onChange:d=>{c({type:"update:common.generation",value:d})},list:ie,listTranslate:"admin.channels.groups",placeholder:l("admin.system.groupPlaceholder",{length:(t.generation??[]).length})})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await s(),children:l("admin.system.save")})]})]})}function us({data:a,dispatch:t,onChange:c}){const{t:s}=P(),[l,m]=b.useState(""),[u,d]=b.useState("1"),[p,y]=b.useState("1"),[x,n]=b.useState(""),g=["anonymous","normal","basic","standard","pro","admin"],N=b.useMemo(()=>{const o=Object.entries(a.group||{}),k=o.filter(([f])=>g.includes(f)).sort((f,K)=>g.indexOf(f[0])-g.indexOf(K[0])),I=o.filter(([f])=>!g.includes(f));return[...k,...I]},[a.group]);return e.jsxs(T,{title:s("admin.group-setting"),configParagraph:!0,isCollapsed:!0,isPro:!0,children:[e.jsx(_,{border:!0,hideIcon:!0,children:s("admin.charge.group-pricing-tip")}),e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-row flex-wrap",children:e.jsxs(he,{classNameArea:"w-full",children:[e.jsx(xe,{children:e.jsxs(O,{children:[e.jsx(L,{children:s("admin.system.group")}),e.jsx(L,{children:s("admin.system.type")}),e.jsx(L,{children:s("admin.system.buy-price")}),e.jsx(L,{children:s("admin.system.consume-price")}),e.jsxs(L,{className:"flex flex-row items-center w-fit",children:[s("admin.system.token-group"),e.jsx(C,{content:s("admin.system.token-group-tip")})]}),e.jsx(L,{children:s("description")}),e.jsx(L,{children:s("admin.system.actions")})]})}),e.jsx(pe,{children:N.map(([o,k])=>e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"font-medium",children:o})]})}),e.jsx(z,{children:e.jsx(U,{variant:g.includes(o)?"secondary":"outline",children:g.includes(o)?s(`admin.channels.groups.${o}`):s("admin.channels.groups.custom")})}),e.jsx(z,{children:k.buy_price||1}),e.jsx(z,{children:k.consume_price||1}),e.jsx(z,{children:e.jsx(w,{disabled:g.includes(o),checked:!!k.token_group,onCheckedChange:I=>{t({type:"update:common.group",value:{...a.group,[o]:{...k,token_group:I}}})}})}),e.jsx(z,{children:k.description||s("none")}),e.jsx(z,{className:"w-fit",children:e.jsxs("div",{className:"flex items-center space-x-2 w-fit",children:[e.jsxs(j,{variant:"outline",size:"sm",className:"flex-shrink-0",onClick:()=>{m(o),d(a.group[o].buy_price.toString()||"1"),y(a.group[o].consume_price.toString()||"1"),n(a.group[o].description||"")},children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),s("admin.system.edit")]}),e.jsxs(j,{variant:"destructive",size:"sm",className:"flex-shrink-0",disabled:g.includes(o),onClick:()=>{const{[o]:I,...f}=a.group;t({type:"update:common.group",value:f})},children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),s("admin.system.delete")]})]})})]},o))})]})}),e.jsxs("div",{className:"flex flex-col space-y-2 mt-2 border p-4 rounded-md",children:[e.jsxs(i,{className:"text-sm font-bold mb-1 flex flex-row items-center w-fit",children:[e.jsx(es,{className:"w-4 h-4 mr-1"}),s("admin.charge.add-new-group")]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx(i,{htmlFor:"new-group",children:s("admin.charge.new-group")}),e.jsx(h,{id:"new-group",placeholder:s("admin.charge.new-group"),value:l,onChange:o=>m(o.target.value)})]}),e.jsxs("div",{className:"w-24 shrink-0",children:[e.jsx(i,{htmlFor:"new-buy-price",children:s("admin.charge.new-group-buy-price")}),e.jsx(h,{id:"new-buy-price",type:"number",placeholder:s("admin.charge.new-group-buy-price"),value:u,onChange:o=>d(o.target.value)})]}),e.jsxs("div",{className:"w-24 shrink-0",children:[e.jsx(i,{htmlFor:"new-consume-price",children:s("admin.charge.new-group-consume-price")}),e.jsx(h,{id:"new-consume-price",type:"number",placeholder:s("admin.charge.new-group-consume-price"),value:p,onChange:o=>y(o.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"new-description",children:s("admin.charge.new-group-description")}),e.jsx(h,{id:"new-description",placeholder:s("admin.charge.new-group-description"),value:x,onChange:o=>n(o.target.value)})]}),e.jsxs(j,{onClick:()=>{if(l.trim()!==""){const o={...a.group,[l.trim()]:{buy_price:parseFloat(u.trim())||1,consume_price:parseFloat(p.trim())||1,token_group:!1,description:x.trim()}};t({type:"update:common.group",value:o}),m(""),d("1"),y("1"),n("")}},classNameWrapper:"ml-auto",disabled:l.trim()===""||u.trim()===""||p.trim()==="",children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),N.find(([o])=>o===l.trim())?s("admin.charge.update-group"):s("admin.charge.add-group")]})]})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function hs({data:a,dispatch:t,onChange:c}){const{t:s}=P(),[l,m]=b.useState(""),[u,d]=b.useState(!1),[p,y]=b.useState(""),[x,n]=b.useState(!1),[g,N]=b.useState([]);return ce(async()=>{const o=await Re();N(o.map(k=>k.id))},[]),e.jsxs(T,{title:s("admin.system.search"),configParagraph:!0,isCollapsed:!0,children:[e.jsx(_,{border:!0,children:s("admin.system.searchTip")}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.searchEndpoint")}),e.jsx(h,{value:a.endpoint,onChange:o=>t({type:"update:search.endpoint",value:o.target.value}),placeholder:s("admin.system.searchPlaceholder")})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.searchSafeSearch")}),e.jsx(me,{value:["none","moderation","strict"][a.safe_search]||"none",onChange:o=>{t({type:"update:search.safe_search",value:["none","moderation","strict"].indexOf(o)})},list:["none","moderation","strict"],listTranslated:"admin.system.searchSafeSearchModes",hideSearchBar:!0})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.searchEngines")}),e.jsx(R,{value:a.engines,onChange:o=>{t({type:"update:search.engines",value:o})},list:["google","bing","duckduckgo","qwant","brave","mojeek","arxiv","crossref","youtube","bilibili","presearch","yahoo","wiby","seznam","goo","naver","wikidata","wikipedia","wikimini","wikibooks","wikiquote","wikisource","wikispecies","wikiversity","wikivoyage","ask","currency","yep","yacy","genius","github","gitlab","gitea.com","bitbucket","codeberg","mdn"],placeholder:s("admin.system.searchEnginesPlaceholder",{length:(a.engines||[]).length}),searchPlaceholder:s("admin.system.searchEnginesSearchPlaceholder")})]}),a.engines.length===0&&e.jsx(_,{border:!0,children:s("admin.system.searchEnginesEmptyTip")}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.searchImageProxy"),e.jsx(C,{content:s("admin.system.searchImageProxyTip")})]}),e.jsx(w,{checked:a.image_proxy,onCheckedChange:o=>{t({type:"update:search.image_proxy",value:o})}})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.searchLLMExtract"),e.jsx(C,{content:s("admin.system.searchLLMExtractTip")})]}),e.jsx(w,{checked:a.llm_extract,onCheckedChange:o=>{t({type:"update:search.llm_extract",value:o})}})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.searchLLMModel")}),e.jsxs(Q,{value:a.llm_model,onValueChange:o=>{t({type:"update:search.llm_model",value:o})},disabled:!a.llm_extract,children:[e.jsx(J,{className:"select",children:e.jsx(X,{placeholder:s("admin.system.searchLLMModelPlaceholder")})}),e.jsx(Z,{children:g.map(o=>e.jsx(q,{value:o,children:De(o)},o))})]})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center",children:[s("admin.system.searchCrop"),e.jsx(C,{content:s("admin.system.searchCropTip")})]}),e.jsx(w,{checked:a.crop,onCheckedChange:o=>{t({type:"update:search.crop",value:o})}})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.searchCropLen")}),e.jsx(M,{value:a.crop_len,onValueChange:o=>t({type:"update:search.crop_len",value:o}),min:1,disabled:!a.crop})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsxs(Y,{open:u,onOpenChange:d,children:[e.jsx(ee,{asChild:!0,children:e.jsx(j,{variant:"outline",size:"sm",children:s("admin.system.searchTest")})}),e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:s("admin.system.searchTest")}),e.jsx(E,{placeholder:s("admin.system.searchTestTip"),value:l,onChange:o=>m(o.target.value)}),(x||p)&&e.jsx("div",{className:"mt-2 border rounded-md p-4 flex items-center justify-center flex-col",children:x?e.jsx($e,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm mb-1",children:"SearXNG Result"}),e.jsx(H,{value:p,rows:5,readOnly:!0})]})})]}),e.jsxs(ne,{children:[e.jsx(j,{unClickable:!0,variant:"outline",onClick:()=>{m(""),d(!1)},children:s("admin.cancel")}),e.jsx(j,{unClickable:!0,variant:"default",loading:!0,onClick:async()=>{await c(),y(""),n(!0);const o=await Ve(l);o.status&&y(o.result),V(s,o,!0),n(!1)},children:s("admin.confirm")})]})]})]}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function xs({data:a,dispatch:t,onChange:c}){var l,m,u;const{t:s}=P();return e.jsxs(T,{title:s("admin.system.stripeTitle"),configParagraph:!0,isCollapsed:!0,isPro:!0,children:[e.jsx(_,{border:!0,children:s("admin.system.stripeTip")}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.stripeEnabled")]}),e.jsx(w,{checked:((l=a.stripe)==null?void 0:l.enabled)||!1,onCheckedChange:d=>{t({type:"update:payment.stripe.enabled",value:d})}})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.stripeSecretKey")]}),e.jsx(h,{value:((m=a.stripe)==null?void 0:m.secret_key)||"",onChange:d=>t({type:"update:payment.stripe.secret_key",value:d.target.value}),placeholder:s("admin.system.stripeSecretKeyPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.stripeWebhookSecret")]}),e.jsx(h,{value:((u=a.stripe)==null?void 0:u.webhook_secret)||"",onChange:d=>t({type:"update:payment.stripe.webhook_secret",value:d.target.value}),placeholder:s("admin.system.stripeWebhookSecretPlaceholder")})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function ps({data:a,dispatch:t,onChange:c}){var l,m,u,d,p,y,x;const{t:s}=P();return e.jsxs(T,{title:s("admin.system.epayTitle"),configParagraph:!0,isCollapsed:!0,isPro:!0,children:[e.jsx(_,{border:!0,children:s("admin.system.epayTip")}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.epayEnabled")]}),e.jsx(w,{checked:((l=a.epay)==null?void 0:l.enabled)||!1,onCheckedChange:n=>{t({type:"update:payment.epay.enabled",value:n})}})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.epayDomain")]}),e.jsx(h,{value:((m=a.epay)==null?void 0:m.domain)||"",onChange:n=>t({type:"update:payment.epay.domain",value:n.target.value}),placeholder:s("admin.system.epayDomainPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.epayBusinessId")]}),e.jsx(h,{value:((u=a.epay)==null?void 0:u.business_id)||"",onChange:n=>t({type:"update:payment.epay.business_id",value:n.target.value}),placeholder:s("admin.system.epayBusinessIdPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.epayBusinessKey")]}),e.jsx(h,{value:((d=a.epay)==null?void 0:d.business_key)||"",onChange:n=>t({type:"update:payment.epay.business_key",value:n.target.value}),placeholder:s("admin.system.epayBusinessKeyPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.epayMethods")]}),e.jsx(R,{value:((p=a.epay)==null?void 0:p.methods)||[],onChange:n=>{t({type:"update:payment.epay.methods",value:n})},list:Qe,listTranslateFormatter:n=>e.jsxs(e.Fragment,{children:[e.jsx(Je,{type:n,className:"h-6 w-6 p-0.5 mr-2"}),s(`payment.${n}`),e.jsx(U,{className:"ml-2",children:n})]}),placeholder:s("admin.system.epayMethodsPlaceholder",{length:(((y=a.epay)==null?void 0:y.methods)||[]).length})})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.epayAggregation")}),e.jsx(w,{checked:((x=a.epay)==null?void 0:x.aggregation)||!1,onCheckedChange:n=>{t({type:"update:payment.epay.aggregation",value:n})}})]}),e.jsx(_,{border:!0,children:s("admin.system.epayAggregationTip")}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function ys({data:a,dispatch:t,onChange:c}){var l,m,u,d,p,y;const{t:s}=P();return e.jsxs(T,{title:s("admin.system.wechatPayTitle"),configParagraph:!0,isCollapsed:!0,isPro:!0,children:[e.jsx(_,{border:!0,children:s("admin.system.wechatPayTip")}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.wechatPayEnabled")]}),e.jsx(w,{checked:((l=a.wechatpay)==null?void 0:l.enabled)||!1,onCheckedChange:x=>{t({type:"update:payment.wechatpay.enabled",value:x})}})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.wechatPayAppId")]}),e.jsx(h,{value:((m=a.wechatpay)==null?void 0:m.app_id)||"",onChange:x=>t({type:"update:payment.wechatpay.app_id",value:x.target.value}),placeholder:s("admin.system.wechatPayAppIdPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.wechatPayMchId")]}),e.jsx(h,{value:((u=a.wechatpay)==null?void 0:u.mch_id)||"",onChange:x=>t({type:"update:payment.wechatpay.mch_id",value:x.target.value}),placeholder:s("admin.system.wechatPayMchIdPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.wechatPayKey")]}),e.jsx(h,{value:((d=a.wechatpay)==null?void 0:d.apiv3_key)||"",onChange:x=>t({type:"update:payment.wechatpay.apiv3_key",value:x.target.value}),placeholder:s("admin.system.wechatPayKeyPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.wechatPaySerialNo")]}),e.jsx(h,{value:((p=a.wechatpay)==null?void 0:p.serial_no)||"",onChange:x=>t({type:"update:payment.wechatpay.serial_no",value:x.target.value}),placeholder:s("admin.system.wechatPaySerialNoPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.wechatPayCertificate")]}),e.jsx(E,{value:((y=a.wechatpay)==null?void 0:y.wechatcertificate)||"",rows:6,onChange:x=>t({type:"update:payment.wechatpay.wechatcertificate",value:x.target.value}),placeholder:s("admin.system.wechatPayCertificatePlaceholder")})]}),e.jsx(_,{border:!0,children:s("admin.system.wechatPayCertificateTip")}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function js({data:a,dispatch:t,onChange:c}){var l,m,u,d,p,y,x;const{t:s}=P();return e.jsxs(T,{title:s("admin.system.xunhupayTitle"),configParagraph:!0,isCollapsed:!0,isPro:!0,children:[e.jsx(_,{border:!0,children:s("admin.system.xunhupayTip")}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.xunhupayWechatEnabled")}),e.jsx(w,{checked:((l=a.xunhupay)==null?void 0:l.wechat_enabled)||!1,onCheckedChange:n=>{t({type:"update:payment.xunhupay.wechat_enabled",value:n})}})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.xunhupayWechatAppId")]}),e.jsx(h,{value:((m=a.xunhupay)==null?void 0:m.wechat_app_id)||"",onChange:n=>t({type:"update:payment.xunhupay.wechat_app_id",value:n.target.value}),placeholder:s("admin.system.xunhupayWechatAppIdPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.xunhupayWechatAppSecret")]}),e.jsx(h,{value:((u=a.xunhupay)==null?void 0:u.wechat_app_secret)||"",onChange:n=>t({type:"update:payment.xunhupay.wechat_app_secret",value:n.target.value}),placeholder:s("admin.system.xunhupayWechatAppSecretPlaceholder")})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.xunhupayAlipayEnabled")}),e.jsx(w,{checked:((d=a.xunhupay)==null?void 0:d.alipay_enabled)||!1,onCheckedChange:n=>{t({type:"update:payment.xunhupay.alipay_enabled",value:n})}})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.xunhupayAlipayAppId")]}),e.jsx(h,{value:((p=a.xunhupay)==null?void 0:p.alipay_app_id)||"",onChange:n=>t({type:"update:payment.xunhupay.alipay_app_id",value:n.target.value}),placeholder:s("admin.system.xunhupayAlipayAppIdPlaceholder")})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.xunhupayAlipayAppSecret")]}),e.jsx(h,{value:((y=a.xunhupay)==null?void 0:y.alipay_app_secret)||"",onChange:n=>t({type:"update:payment.xunhupay.alipay_app_secret",value:n.target.value}),placeholder:s("admin.system.xunhupayAlipayAppSecretPlaceholder")})]}),e.jsx(W,{}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.xunhupayEndpoint")]}),e.jsx(h,{value:((x=a.xunhupay)==null?void 0:x.endpoint)||"",onChange:n=>t({type:"update:payment.xunhupay.endpoint",value:n.target.value}),placeholder:s("admin.system.xunhupayEndpointPlaceholder")})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function gs({data:a,dispatch:t,onChange:c}){const{t:s}=P(),l=a.affiliate||{enabled:!1,commission_rate:.1,min_withdraw:10,allow_existing_bind:!1};return e.jsxs(T,{title:s("admin.system.affiliateTitle"),configParagraph:!0,isCollapsed:!0,isPro:!0,children:[e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.affiliateEnabled")}),e.jsx(w,{checked:l.enabled,onCheckedChange:m=>t({type:"update:payment.affiliate.enabled",value:m})})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[s("admin.system.affiliateCommissionRate")," (%)"]}),e.jsx(M,{value:(l.commission_rate??0)*100,onValueChange:m=>{const u=Math.max(0,Math.min(100,Number(m||0)))/100;t({type:"update:payment.affiliate.commission_rate",value:u})},min:0,max:100})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.affiliateMinWithdraw")}),e.jsx(M,{value:l.min_withdraw,onValueChange:m=>t({type:"update:payment.affiliate.min_withdraw",value:m}),min:0})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function vs({data:a,dispatch:t,onChange:c}){const{t:s}=P(),{channelModels:l}=ue(),[m,u]=b.useState(""),[d,p]=b.useState(""),y=a.blacklist_ips||[],x=a.whitelist_ips||[];return e.jsxs(T,{title:s("admin.system.security"),configParagraph:!0,isCollapsed:!0,isPro:!0,children:[e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(v,{})," ",s("admin.system.securityCheckType")]}),e.jsx(me,{value:a.check_type,onChange:n=>{t({type:"update:security.check_type",value:n})},list:We,listTranslated:"admin.system.securityTypes",placeholder:s("admin.system.securityCheckTypePlaceholder")})]}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.securityCheckModels")}),e.jsx(R,{value:a.check_models||[],onChange:n=>{t({type:"update:security.check_models",value:n})},list:l,placeholder:s("admin.system.securityCheckModelsPlaceholder",{length:(a.check_models||[]).length})})]}),e.jsx(_,{border:!0,children:s("admin.system.securityCheckModelsTip")}),e.jsxs(r,{rowLayout:!0,children:[e.jsxs(i,{children:[a.check_type==A.Dict&&e.jsx(v,{})," ",s("admin.system.securityTextDatabase")]}),e.jsx(H,{rows:3,value:a.text_database,onChange:n=>t({type:"update:security.text_database",value:n.target.value}),placeholder:s("admin.system.securityTextDatabasePlaceholder"),disabled:a.check_type!==A.Dict})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsxs(i,{children:[a.check_type==A.Regex&&e.jsx(v,{})," ",s("admin.system.securityRegexDatabase")]}),e.jsx(H,{rows:3,value:a.regex_database,onChange:n=>t({type:"update:security.regex_database",value:n.target.value}),placeholder:s("admin.system.securityRegexDatabasePlaceholder"),disabled:a.check_type!==A.Regex})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[a.check_type==A.Baidu&&e.jsx(v,{})," ",s("admin.system.securityBaiduApiKey")]}),e.jsx(h,{value:a.baidu_api_key,onChange:n=>t({type:"update:security.baidu_api_key",value:n.target.value}),placeholder:s("admin.system.securityBaiduApiKeyPlaceholder"),disabled:a.check_type!==A.Baidu})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[a.check_type==A.Baidu&&e.jsx(v,{})," ",s("admin.system.securityBaiduSecretKey")]}),e.jsx(h,{value:a.baidu_secret_key,onChange:n=>t({type:"update:security.baidu_secret_key",value:n.target.value}),placeholder:s("admin.system.securityBaiduSecretKeyPlaceholder"),disabled:a.check_type!==A.Baidu})]}),e.jsx(_,{border:!0,children:s("admin.system.securityBaiduTip")}),e.jsxs(r,{children:[e.jsxs(i,{children:[a.check_type==A.Custom&&e.jsx(v,{})," ",s("admin.system.securityCustomEndpoint")]}),e.jsx(h,{value:a.custom_endpoint,onChange:n=>t({type:"update:security.custom_endpoint",value:n.target.value}),placeholder:s("admin.system.securityCustomEndpointPlaceholder"),disabled:a.check_type!==A.Custom})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[a.check_type==A.Custom&&e.jsx(v,{})," ",s("admin.system.securityCustomToken")]}),e.jsx(h,{value:a.custom_audit_token,onChange:n=>t({type:"update:security.custom_audit_token",value:n.target.value}),placeholder:s("admin.system.securityCustomTokenPlaceholder"),disabled:a.check_type!==A.Custom})]}),e.jsx(_,{border:!0,children:s("admin.system.securityCustomTip")}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.securityBlacklistIPs")}),e.jsxs("div",{className:"flex flex-col w-full gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{value:m,onChange:n=>u(n.target.value),placeholder:s("admin.system.securityBlacklistIPsPlaceholder"),className:"flex-1",onKeyDown:n=>{if(n.key==="Enter"&&m&&!y.includes(m)){const g=[...y,m];t({type:"update:security.blacklist_ips",value:g}),u("")}}}),e.jsx(j,{size:"sm",onClick:()=>{if(m&&!y.includes(m)){const n=[...y,m];t({type:"update:security.blacklist_ips",value:n}),u("")}},children:s("admin.system.securityAddIPAddress")})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((n,g)=>e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 dark:bg-neutral-700 px-2 py-1 rounded-md",children:[e.jsx("span",{children:n}),e.jsx(j,{variant:"ghost",size:"icon",className:"h-5 w-5 p-0 text-red-500 hover:text-red-700 hover:bg-transparent",onClick:()=>{const N=y.filter((o,k)=>k!==g);t({type:"update:security.blacklist_ips",value:N})},children:e.jsx(G,{className:"h-3 w-3"})})]},`blacklist-${g}`))})]})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.securityWhitelistIPs")}),e.jsxs("div",{className:"flex flex-col w-full gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{value:d,onChange:n=>p(n.target.value),placeholder:s("admin.system.securityWhitelistIPsPlaceholder"),className:"flex-1",onKeyDown:n=>{if(n.key==="Enter"&&d&&!x.includes(d)){const g=[...x,d];t({type:"update:security.whitelist_ips",value:g}),p("")}}}),e.jsx(j,{size:"sm",onClick:()=>{if(d&&!x.includes(d)){const n=[...x,d];t({type:"update:security.whitelist_ips",value:n}),p("")}},children:s("admin.system.securityAddIPAddress")})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map((n,g)=>e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 dark:bg-neutral-700 px-2 py-1 rounded-md",children:[e.jsx("span",{children:n}),e.jsx(j,{variant:"ghost",size:"icon",className:"h-5 w-5 p-0 text-red-500 hover:text-red-700 hover:bg-transparent",onClick:()=>{const N=x.filter((o,k)=>k!==g);t({type:"update:security.whitelist_ips",value:N})},children:e.jsx(G,{className:"h-3 w-3"})})]},`whitelist-${g}`))})]})]}),e.jsx(_,{border:!0,children:s("admin.system.securityWhitelistIPsTip")}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function fs({data:a,dispatch:t,onChange:c}){const{t:s}=P();return e.jsxs(T,{title:s("admin.system.custom"),configParagraph:!0,isCollapsed:!0,children:[e.jsx(_,{border:!0,children:s("admin.system.customThemeAlert")}),e.jsxs(r,{children:[e.jsx(i,{children:s("admin.system.gaTrackingId")}),e.jsx(h,{value:a.ga_tracking_id,onChange:l=>t({type:"update:custom.ga_tracking_id",value:l.target.value}),placeholder:s("admin.system.gaTrackingIdPlaceholder")})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.customJs")}),e.jsx(E,{value:a.custom_js,rows:12,onChange:l=>t({type:"update:custom.custom_js",value:l.target.value}),placeholder:s("admin.system.customJsPlaceholder")})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.customCss")}),e.jsx(E,{value:a.custom_css,rows:12,onChange:l=>t({type:"update:custom.custom_css",value:l.target.value}),placeholder:s("admin.system.customCssPlaceholder")})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:s("admin.system.customHtml")}),e.jsx(E,{value:a.custom_html,rows:12,onChange:l=>t({type:"update:custom.custom_html",value:l.target.value}),placeholder:s("admin.system.customHtmlPlaceholder")})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await c(),children:s("admin.system.save")})]})]})}function Ls(){var u,d,p,y,x,n,g,N,o,k,I;const{t:a}=P(),[t,c]=b.useReducer(ye(),je),s=ge()[0].get("tab")||"general",l=async f=>{const K=await Be(t);f!==!1&&V(a,K,!0)};return ce(async()=>{const f=await qe();V(a,f),f.status&&c({type:"set",value:f.data})},[]),e.jsx("div",{className:"system",children:e.jsxs(ve,{className:"admin-card system-card",children:[e.jsx(fe,{className:"select-none pb-0",children:e.jsxs(we,{className:"flex flex-row items-center",children:[a("admin.settings"),e.jsx(U,{className:"ml-2",variant:"gold",children:"Pro"})]})}),e.jsx(Ce,{className:"flex flex-col gap-1",children:e.jsxs(be,{defaultValue:s,className:"w-full flex flex-col items-center mt-4",onValueChange:f=>{window.history.replaceState({},"",`?tab=${f}`)},children:[e.jsxs(_e,{className:"transition-all w-full h-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6",children:[e.jsxs(D,{value:"general",children:[e.jsx(F,{className:"w-4 h-4 mr-1"}),a("admin.system.general")]}),e.jsxs(D,{value:"site",children:[e.jsx(ke,{className:"w-4 h-4 mr-1"}),a("admin.system.operation")]}),e.jsxs(D,{value:"pay",children:[e.jsx(Xe,{className:"w-4 h-4 mr-1"}),a("admin.system.payment")]}),e.jsxs(D,{value:"security",children:[e.jsx(Ne,{className:"w-4 h-4 mr-1"}),a("admin.system.security")]}),e.jsxs(D,{value:"chat",children:[e.jsx(Pe,{className:"w-4 h-4 mr-1"}),a("admin.system.chat")]}),e.jsxs(D,{value:"custom",children:[e.jsx(ns,{className:"w-4 h-4 mr-1"}),a("admin.system.custom")]})]}),e.jsxs($,{value:"general",className:"w-full mt-0",children:[e.jsx(is,{form:t,data:t.general,dispatch:c,onChange:l}),e.jsx(ms,{form:t,data:t.common,dispatch:c,onChange:l}),e.jsx(us,{form:t,data:t.common,dispatch:c,onChange:l})]}),e.jsxs($,{value:"pay",className:"w-full mt-0",children:[e.jsx(ps,{form:t,data:t.payment,dispatch:c,onChange:l}),e.jsx(ys,{form:t,data:t.payment,dispatch:c,onChange:l}),e.jsx(js,{form:t,data:t.payment,dispatch:c,onChange:l}),e.jsx(xs,{form:t,data:t.payment,dispatch:c,onChange:l}),e.jsx(gs,{form:t,data:t.payment,dispatch:c,onChange:l}),e.jsx(rs,{form:t,dispatch:c,onChange:l})]}),e.jsxs($,{value:"site",className:"w-full mt-0",children:[e.jsx(os,{form:t,data:t.site,dispatch:c,onChange:l}),e.jsx(cs,{form:t,data:t.oauth,dispatch:c,onChange:l}),e.jsx(ds,{form:t,data:t.mail,dispatch:c,onChange:l})]}),e.jsx($,{value:"security",className:"w-full mt-0",children:e.jsx(vs,{form:t,data:t.security,dispatch:c,onChange:l})}),e.jsxs($,{value:"chat",className:"w-full mt-0",children:[e.jsx(hs,{form:t,data:t.search,dispatch:c,onChange:l}),e.jsxs(T,{title:a("admin.system.autoTitle.title"),configParagraph:!0,isCollapsed:!0,children:[e.jsx(_,{border:!0,children:a("admin.system.autoTitle.tip")}),e.jsxs(r,{children:[e.jsx(i,{className:"flex flex-row items-center",children:a("admin.system.autoTitle.enabled")}),e.jsx(w,{checked:!!((u=t.auto_title)!=null&&u.enabled),onCheckedChange:f=>c({type:"update:auto_title.enabled",value:f})})]}),e.jsxs(r,{children:[e.jsx(i,{children:a("admin.system.autoTitle.model")}),e.jsx(h,{value:((d=t.auto_title)==null?void 0:d.model)||"",onChange:f=>c({type:"update:auto_title.model",value:f.target.value}),placeholder:a("admin.system.autoTitle.modelPlaceholder"),disabled:!((p=t.auto_title)!=null&&p.enabled)})]}),e.jsxs(r,{children:[e.jsx(i,{children:a("admin.system.autoTitle.maxLen")}),e.jsx(M,{value:((y=t.auto_title)==null?void 0:y.max_len)??50,onValueChange:f=>c({type:"update:auto_title.max_len",value:f}),min:10,max:200,disabled:!((x=t.auto_title)!=null&&x.enabled)})]}),e.jsxs(r,{children:[e.jsx(i,{children:a("admin.system.autoTitle.minMsgs")}),e.jsx(M,{value:((n=t.auto_title)==null?void 0:n.min_msgs)??6,onValueChange:f=>c({type:"update:auto_title.min_msgs",value:f}),min:1,max:20,disabled:!((g=t.auto_title)!=null&&g.enabled)})]}),e.jsxs(r,{children:[e.jsx(i,{children:a("admin.system.autoTitle.overwrite")}),e.jsx(w,{checked:!!((N=t.auto_title)!=null&&N.overwrite),onCheckedChange:f=>c({type:"update:auto_title.overwrite",value:f}),disabled:!((o=t.auto_title)!=null&&o.enabled)})]}),e.jsxs(r,{rowLayout:!0,children:[e.jsx(i,{children:a("admin.system.autoTitle.prompt")}),e.jsx(E,{rows:6,value:((k=t.auto_title)==null?void 0:k.prompt)||"",onChange:f=>c({type:"update:auto_title.prompt",value:f.target.value}),placeholder:a("admin.system.autoTitle.promptPlaceholder"),disabled:!((I=t.auto_title)!=null&&I.enabled)})]}),e.jsxs(S,{children:[e.jsx("div",{className:"grow"}),e.jsx(j,{size:"sm",loading:!0,onClick:async()=>await l(),children:a("admin.system.save")})]})]})]}),e.jsx($,{value:"custom",className:"w-full mt-0",children:e.jsx(fs,{form:t,data:t.custom,dispatch:c,onChange:l})})]})})]})})}export{Ls as default};
