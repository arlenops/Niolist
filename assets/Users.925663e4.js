import{c as A,u as _,j as e,bs as M,r as c,bG as Z,eh as ue,cs as pe,aW as xe,aL as je,bk as he,cP as R,a5 as w,aV as ee,a3 as F,a4 as ae,a6 as V,a7 as G,a8 as I,as as E,I as T,a9 as $,d0 as ge,ei as be,J as D,ej as we,a0 as qe,e as X,f as _e,L as De,bE as Te,dR as fe,ek as Me,e6 as Le,el as Pe,cK as Fe,d as Ve,O as Y,a as re,at as Ie,bB as Ee,dm as S,dn as O,em as de,eg as oe,aH as $e,aI as Ae,bu as ze,aJ as Be,bv as N,bK as Ge,en as Ue,d4 as He,bR as K,bS as Q,bT as J,bV as W}from"./index.59694a49.js";import{T as se,a as te,b as L,c as r,d as ne,e as d}from"./table.ca326b4a.js";import{f as Ke,h as Qe,j as Je,k as We,u as Xe,l as Ye,q as me,s as Ze,m as Re,r as ea,n as aa,o as sa,p as ta,t as na,v as ia,w as ca,x as la}from"./chart.45f0f3e6.js";import{P as ie}from"./pagination.ad8d74d6.js";import{O as Ne}from"./OperationAction.02f00643.js";import{R as ra,a as da}from"./radio-group.dc3d14ec.js";import{F as oa}from"./funnel.1dc762bc.js";import{K as ma}from"./key-round.fc144d47.js";import{C as ua}from"./circle-plus.805285b4.js";import{C as pa}from"./calendar-clock.6066c086.js";import{C as xa}from"./calendar-off.ac4b6a10.js";import{U as ja}from"./users.29f7cbd5.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h4",key:"6d7r33"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h10",key:"1438ji"}]],ga=A("ArrowDownNarrowWide",ha);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],wa=A("CircleMinus",ba);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],Na=A("CloudFog",fa);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],Ca=A("Mail",va);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}]],ve=A("ShieldMinus",ya);function Ce({state:a}){const{t:s}=_();return e.jsx(M,{variant:"outline",children:s(`admin.used-${a}`)})}function ka({update:a}){const{t:s}=_(),[t,x]=c.useState(!1),[g,u]=c.useState(""),[f,m]=c.useState("5"),[n,j]=c.useState("1"),[o,v]=c.useState("");function y(b){return b.replace(/[^\d.]/g,"")}async function k(){const b=await Je(g,Number(f),Number(n));b.status?(v(b.data.join(`
`)),a()):D.error(s("admin.error"),{description:b.message})}function p(){u(""),m("5"),j("1"),x(!1),v("")}function i(){return we("invitation.txt",o)}return e.jsxs(e.Fragment,{children:[e.jsxs(F,{open:t,onOpenChange:x,children:[e.jsx(ae,{asChild:!0,children:e.jsx(w,{children:s("admin.generate")})}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(I,{children:s("admin.generate")}),e.jsxs(E,{className:"pt-2",children:[e.jsxs("div",{className:"invitation-row",children:[e.jsx("p",{className:"mr-4",children:s("admin.type")}),e.jsx(T,{value:g,onChange:b=>u(b.target.value)})]}),e.jsxs("div",{className:"invitation-row",children:[e.jsx("p",{className:"mr-4",children:s("admin.quota")}),e.jsx(T,{value:f,onChange:b=>m(y(b.target.value))})]}),e.jsxs("div",{className:"invitation-row",children:[e.jsx("p",{className:"mr-4",children:s("admin.number")}),e.jsx(T,{value:n,onChange:b=>j(y(b.target.value))})]})]})]}),e.jsxs($,{children:[e.jsx(w,{variant:"outline",onClick:()=>x(!1),children:s("admin.cancel")}),e.jsx(w,{variant:"default",loading:!0,onClick:k,children:s("admin.confirm")})]})]})]}),e.jsx(F,{open:o!=="",onOpenChange:b=>{b||p()},children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(I,{children:s("admin.generate-result")}),e.jsx(E,{className:"pt-4",children:e.jsx(ge,{value:o,rows:12,readOnly:!0})})]}),e.jsxs($,{children:[e.jsx(w,{unClickable:!0,variant:"outline",onClick:p,children:s("close")}),e.jsxs(w,{unClickable:!0,variant:"default",onClick:i,children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),s("download")]})]})]})})]})}function Sa(){const{t:a}=_(),[s,t]=c.useState({total:0,data:[]}),[x,g]=c.useState(!1),[u,f]=c.useState(0);async function m(){g(!0);const n=await Qe(u);g(!1),n.status?t(n):D.error(a("admin.error"),{description:n.message})}return Z(m,[u]),e.jsxs("div",{className:"invitation-table",children:[s.data&&s.data.length>0||u>0?e.jsxs(e.Fragment,{children:[e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(L,{className:"select-none whitespace-nowrap",children:[e.jsx(r,{children:a("admin.invitation-code")}),e.jsx(r,{children:a("admin.quota")}),e.jsx(r,{children:a("admin.type")}),e.jsx(r,{children:a("admin.used")}),e.jsx(r,{children:a("admin.used-username")}),e.jsx(r,{children:a("admin.created-at")}),e.jsx(r,{children:a("admin.used-at")}),e.jsx(r,{children:a("admin.action")})]})}),e.jsx(ne,{children:(s.data||[]).map((n,j)=>e.jsxs(L,{className:"whitespace-nowrap",children:[e.jsx(d,{children:n.code}),e.jsx(d,{children:e.jsx(M,{variant:"outline",children:n.quota})}),e.jsx(d,{children:e.jsx(M,{children:n.type})}),e.jsx(d,{children:e.jsx(Ce,{state:n.used})}),e.jsx(d,{children:n.username||"-"}),e.jsx(d,{children:n.created_at}),e.jsx(d,{children:n.updated_at}),e.jsxs(d,{className:"flex gap-2",children:[e.jsx(ue,{size:"icon",variant:"outline",onClick:()=>pe(n.code),children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(Ne,{native:!0,tooltip:a("delete"),variant:"destructive",onClick:async()=>{const o=await Ke(n.code);je(a,o,!0),o.status&&await m()},children:e.jsx(he,{className:"h-4 w-4"})})]})]},j))})]}),e.jsx(ie,{current:u,total:s.total,onPageChange:f,offset:!0})]}):e.jsx("div",{className:"empty",children:x?e.jsx(R,{className:"w-6 h-6 inline-block animate-spin"}):e.jsx("p",{children:a("admin.empty")})}),e.jsxs("div",{className:"invitation-action",children:[e.jsx("div",{className:"grow"}),e.jsx(w,{variant:"outline",size:"icon",onClick:m,children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(ka,{update:m})]})]})}const P=qe.forwardRef(({title:a,icon:s,prefix:t,items:x,colLayout:g,defaultValue:u,value:f,onValueChange:m,className:n},j)=>e.jsxs("div",{className:X("inline-flex flex-row text-sm items-center mb-2",g&&"items-start",n),ref:j,children:[e.jsxs("div",{className:"flex flex-row items-center select-none mr-2",children:[s&&e.jsx(_e,{icon:s,className:"w-3.5 h-3.5 mr-1"}),e.jsx("p",{children:a})]}),e.jsx(ra,{defaultValue:u,className:X(g?"grid grid-cols-2 gap-2":"flex flex-row space-x-1"),value:f,onValueChange:m,children:x.map((o,v)=>e.jsxs("div",{className:"flex items-center space-x-1 cursor-pointer",onClick:()=>m&&m(o.id),children:[e.jsx(da,{value:o.id,id:`${t}-${o.id}`}),e.jsx(De,{className:"cursor-pointer",htmlFor:`${t}-${o.id}`,children:o.value})]},v))})]}));P.displayName="RadioBox";const B=["normal","basic_plan","standard_plan","pro_plan"];function q(a,s){s.status?D.success(a("admin.operate-success"),{description:a("admin.operate-success-prompt")}):D.error(a("admin.operate-failed"),{description:a("admin.operate-failed-prompt",{reason:s.message||s.error})})}function Oa({user:a,onRefresh:s}){const{t}=_(),x=re(Ie),g=re(Ee),u=g?Object.fromEntries(Object.entries(g).filter(([l])=>!["anonymous","normal","basic","standard","pro","admin"].includes(l))):{},[f,m]=c.useState(!1),[n,j]=c.useState(!1),[o,v]=c.useState(!1),[y,k]=c.useState(!1),[p,i]=c.useState(!1),[b,z]=c.useState(!1),[ye,ce]=c.useState(!1),[ke,U]=c.useState(!1),[Se,H]=c.useState(!1),[Oe,le]=c.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(S,{destructive:!0,type:O.Text,title:t("admin.password-action"),name:t("auth.password"),description:t("admin.password-action-desc"),open:f,setOpen:m,defaultValue:"",onSubmit:async l=>{const h=await Xe(a.id,l);return q(t,h),h.status&&(x===a.username&&location.reload(),s==null||s()),h.status}}),e.jsx(S,{destructive:!0,type:O.Text,title:t("admin.email-action"),name:t("admin.email"),description:t("admin.email-action-desc"),open:n,setOpen:j,defaultValue:a.email,onSubmit:async l=>{const h=await Ye(a.id,l);return q(t,h),h.status&&(s==null||s()),h.status}}),e.jsx(S,{type:O.Number,title:t("admin.quota-action"),name:t("admin.quota"),description:t("admin.quota-action-desc"),defaultValue:"0",onValueChange:de,open:o,setOpen:v,componentProps:{acceptNegative:!0},onSubmit:async l=>{const h=oe(l),C=await me(a.id,h);return q(t,C),C.status&&(s==null||s()),C.status}}),e.jsx(S,{type:O.Number,title:t("admin.quota-set-action"),name:t("admin.quota"),description:t("admin.quota-set-action-desc"),defaultValue:a.quota.toFixed(2),onValueChange:de,open:y,setOpen:k,componentProps:{acceptNegative:!0},onSubmit:async l=>{const h=oe(l),C=await me(a.id,h,!0);return q(t,C),C.status&&(s==null||s()),C.status}}),e.jsx(S,{type:O.Clock,title:t("admin.subscription-action"),description:t("admin.subscription-action-desc",{username:a.username}),defaultValue:a.expired_at||new Date().toISOString().slice(0,19).replace("T"," "),open:p,setOpen:i,onSubmit:async l=>{const h=await Ze(a.id,l);return q(t,h),h.status&&(s==null||s()),h.status}}),e.jsx(S,{type:O.List,title:t("admin.subscription-level"),name:t("admin.level"),description:t("admin.subscription-level-desc"),defaultValue:B[a.level],params:{dataList:B,dataListTranslated:"admin.identity"},open:b,setOpen:z,onSubmit:async l=>{const h=B.indexOf(l);console.log(h);const C=await Re(a.id,h);return q(t,C),C.status&&(s==null||s()),C.status}}),e.jsx(S,{type:O.Empty,title:t("admin.release-subscription-action"),name:t("admin.release-subscription"),description:t("admin.release-subscription-action-desc"),open:ye,setOpen:ce,onSubmit:async()=>{const l=await ea(a.id);return q(t,l),l.status&&(s==null||s()),l.status}}),e.jsx(S,{disabled:x===a.username,destructive:!0,type:O.Empty,title:a.is_banned?t("admin.unban-action"):t("admin.ban-action"),description:a.is_banned?t("admin.unban-action-desc"):t("admin.ban-action-desc"),open:ke,setOpen:U,onSubmit:async()=>{const l=await aa(a.id,!a.is_banned);return q(t,l),l.status&&(s==null||s()),l.status}}),e.jsx(S,{disabled:x===a.username,destructive:!0,type:O.Empty,title:a.is_admin?t("admin.cancel-admin-action"):t("admin.set-admin-action"),description:a.is_admin?t("admin.cancel-admin-action-desc"):t("admin.set-admin-action-desc"),open:Se,setOpen:H,onSubmit:async()=>{const l=await sa(a.id,!a.is_admin);return q(t,l),l.status&&(s==null||s()),l.status}}),e.jsx(S,{type:O.MultiList,title:t("admin.custom-group-action"),name:t("admin.custom-group"),description:t("admin.custom-group-action-desc"),open:Oe,setOpen:le,defaultValue:a.custom_group?a.custom_group.join(","):"",params:{dataList:u?Object.keys(u):[]},onSubmit:async l=>{const h=await ta(a.id,l.split(","));return q(t,h),h.status&&(s==null||s()),h.status}}),e.jsxs($e,{children:[e.jsx(Ae,{asChild:!0,children:e.jsx(w,{variant:"outline",size:"icon",children:e.jsx(ze,{className:"h-4 w-4"})})}),e.jsxs(Be,{className:"min-w-[8.75rem]",children:[e.jsxs(N,{onClick:()=>m(!0),children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),t("admin.password-action")]}),e.jsxs(N,{onClick:()=>j(!0),children:[e.jsx(Ca,{className:"h-4 w-4 mr-2"}),t("admin.email-action")]}),a.is_banned?e.jsxs(N,{onClick:()=>U(!0),children:[e.jsx(ua,{className:"h-4 w-4 mr-2"}),t("admin.unban-action")]}):e.jsxs(N,{onClick:()=>U(!0),children:[e.jsx(wa,{className:"h-4 w-4 mr-2"}),t("admin.ban-action")]}),a.is_admin?e.jsxs(N,{onClick:()=>H(!0),children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),t("admin.cancel-admin-action")]}):e.jsxs(N,{onClick:()=>H(!0),children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),t("admin.set-admin-action")]}),e.jsxs(N,{onClick:()=>v(!0),children:[e.jsx(Na,{className:"h-4 w-4 mr-2"}),t("admin.quota-action")]}),e.jsxs(N,{onClick:()=>k(!0),children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),t("admin.quota-set-action")]}),e.jsxs(N,{onClick:()=>i(!0),children:[e.jsx(pa,{className:"h-4 w-4 mr-2"}),t("admin.subscription-action")]}),e.jsxs(N,{onClick:()=>z(!0),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),t("admin.subscription-level")]}),e.jsxs(N,{onClick:()=>ce(!0),children:[e.jsx(xa,{className:"h-4 w-4 mr-2"}),t("admin.release-subscription-action")]}),e.jsxs(N,{onClick:()=>le(!0),children:[e.jsx(ja,{className:"h-4 w-4 mr-2"}),t("admin.custom-group-action")]})]})]})]})}function qa(){const{t:a}=_(),[s,t]=c.useState({total:0,data:[]}),[x,g]=c.useState(0),[u,f]=c.useState(""),[m,n]=c.useState(!1),[j,o]=c.useReducer(Te(),{...We}),[v,y]=c.useState(!1),k=c.useMemo(()=>Object.values(j).filter(i=>i!=="all"&&i!=="id-asc").length,[j]);async function p(){n(!0);const i=await na(x,u,j);n(!1),i.status?t(i):D.error(a("admin.error"),{description:i.message})}return Z(p,[x]),e.jsxs("div",{className:"user-table",children:[e.jsxs("div",{className:"flex flex-row mb-6",children:[e.jsxs(F,{open:v,onOpenChange:y,children:[e.jsx(ae,{asChild:!0,children:e.jsxs(w,{size:"icon",className:"shrink-0 mr-2",onClick:p,children:[e.jsx(oa,{className:"h-4 w-4"}),k>0&&e.jsx("span",{className:"text-xs",children:k})]})}),e.jsxs(V,{children:[e.jsx(I,{children:a("filter.filter")}),e.jsx(E,{children:a("filter.conds",{count:k})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(P,{title:a("filter.admin"),icon:e.jsx(fe,{}),prefix:"admin",items:[{id:"all",value:a("filter.all")},{id:"yes",value:a("filter.admin")},{id:"no",value:a("filter.not-admin")}],value:j.admin,onValueChange:i=>o({type:"update:admin",value:i})}),e.jsx(P,{title:a("filter.ban"),icon:e.jsx(ve,{}),prefix:"ban",items:[{id:"all",value:a("filter.all")},{id:"yes",value:a("filter.banned")},{id:"no",value:a("filter.not-banned")}],value:j.ban,onValueChange:i=>o({type:"update:ban",value:i})}),e.jsx(P,{title:a("filter.plan"),icon:e.jsx(Me,{}),prefix:"plan",items:[{id:"all",value:a("filter.all")},{id:"yes",value:a("filter.subscribed")},{id:"no",value:a("filter.unsubscribed")}],value:j.plan,onValueChange:i=>o({type:"update:plan",value:i})}),e.jsx(Le,{}),e.jsx(P,{title:a("filter.sorts.sort"),icon:e.jsx(ga,{}),prefix:"sort",colLayout:!0,className:"mt-2",items:[{id:"id-asc",value:a("filter.sorts.id-asc")},{id:"id-desc",value:a("filter.sorts.id-desc")},{id:"quota-asc",value:a("filter.sorts.quota-asc")},{id:"quota-desc",value:a("filter.sorts.quota-desc")},{id:"used-quota-asc",value:a("filter.sorts.used-quota-asc")},{id:"used-quota-desc",value:a("filter.sorts.used-quota-desc")},{id:"plan-asc",value:a("filter.sorts.plan-asc")},{id:"plan-desc",value:a("filter.sorts.plan-desc")}],value:j.sort,onValueChange:i=>o({type:"update:sort",value:i})})]}),e.jsx($,{children:e.jsx(Pe,{onClick:()=>y(!1),children:a("confirm")})})]})]}),e.jsx(T,{className:"search",placeholder:a("admin.search-username"),value:u,onChange:i=>f(i.target.value),onKeyDown:async i=>{Fe(i)&&await p()}}),e.jsx(w,{size:"icon",className:"flex-shrink-0 ml-2",onClick:p,children:e.jsx(Ve,{className:"h-4 w-4"})})]}),s.data&&s.data.length>0||x>0?e.jsxs(e.Fragment,{children:[e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(L,{className:"select-none whitespace-nowrap",children:[e.jsx(r,{children:"ID"}),e.jsx(r,{children:a("admin.username")}),e.jsx(r,{children:a("admin.group")}),e.jsx(r,{children:a("admin.email")}),e.jsx(r,{children:a("admin.quota")}),e.jsx(r,{children:a("admin.used-quota")}),e.jsx(r,{children:a("admin.is-subscribed")}),e.jsx(r,{children:a("admin.level")}),e.jsx(r,{children:a("admin.total-month")}),e.jsx(r,{children:a("admin.expired-at")}),e.jsx(r,{children:a("admin.is-banned")}),e.jsx(r,{children:a("admin.is-admin")}),e.jsx(r,{children:a("admin.action")})]})}),e.jsx(ne,{children:(s.data||[]).map((i,b)=>e.jsxs(L,{children:[e.jsx(d,{children:i.id}),e.jsx(d,{className:"whitespace-nowrap",children:i.username}),e.jsx(d,{className:"whitespace-nowrap",children:(i.custom_group||[]).length>0?(i.custom_group||[]).map(z=>e.jsx(M,{variant:"outline",className:"m-0.5",children:z})):"-"}),e.jsx(d,{className:"whitespace-nowrap",children:i.email||"-"}),e.jsx(d,{children:i.quota}),e.jsx(d,{children:i.used_quota}),e.jsxs(d,{children:[a(i.is_subscribed.toString()),e.jsx(Y,{className:"inline-block",content:a("admin.is-subscribed-tips")})]}),e.jsx(d,{className:"whitespace-nowrap",children:e.jsx(M,{variant:"outline",children:a(`admin.identity.${B[i.level]}`)})}),e.jsx(d,{children:i.total_month}),e.jsx(d,{className:"whitespace-nowrap",children:i.expired_at||"-"}),e.jsx(d,{children:a(i.is_banned.toString())}),e.jsx(d,{children:a(i.is_admin.toString())}),e.jsx(d,{children:e.jsx(Oa,{user:i,onRefresh:p})})]},b))})]}),e.jsx(ie,{current:x,total:s.total,onPageChange:g,offset:!0})]}):m?e.jsx("div",{className:"flex flex-col mb-4 mt-12 items-center",children:e.jsx(R,{className:"w-6 h-6 inline-block animate-spin"})}):e.jsx("div",{className:"empty",children:e.jsx("p",{children:a("admin.empty")})}),e.jsxs("div",{className:"user-action",children:[e.jsx("div",{className:"grow"}),e.jsx(w,{variant:"outline",size:"icon",onClick:p,children:e.jsx(ee,{className:"h-4 w-4"})})]})]})}function _a({update:a}){const{t:s}=_(),[t,x]=c.useState(!1),[g,u]=c.useState("5"),[f,m]=c.useState("1"),[n,j]=c.useState("");function o(p){return p.replace(/[^\d.]/g,"")}async function v(){const p=await la(Number(g),Number(f));p.status?(j(p.data.join(`
`)),a()):D.error(s("admin.error"),{description:p.message})}function y(){u("5"),m("1"),x(!1),j("")}function k(){return we("code.txt",n)}return e.jsxs(e.Fragment,{children:[e.jsxs(F,{open:t,onOpenChange:x,children:[e.jsx(ae,{asChild:!0,children:e.jsx(w,{children:s("admin.generate")})}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(I,{children:s("admin.generate")}),e.jsxs(E,{className:"pt-2",children:[e.jsxs("div",{className:"redeem-row",children:[e.jsx("p",{className:"mr-4",children:s("admin.quota")}),e.jsx(T,{value:g,onChange:p=>u(o(p.target.value))})]}),e.jsxs("div",{className:"redeem-row",children:[e.jsx("p",{className:"mr-4",children:s("admin.number")}),e.jsx(T,{value:f,onChange:p=>m(o(p.target.value))})]})]})]}),e.jsxs($,{children:[e.jsx(w,{unClickable:!0,variant:"outline",onClick:()=>x(!1),children:s("admin.cancel")}),e.jsx(w,{unClickable:!0,variant:"default",loading:!0,onClick:v,children:s("admin.confirm")})]})]})]}),e.jsx(F,{open:n!=="",onOpenChange:p=>{p||y()},children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(I,{children:s("admin.generate-result")}),e.jsx(E,{className:"pt-4",children:e.jsx(ge,{value:n,rows:12,readOnly:!0})})]}),e.jsxs($,{children:[e.jsx(w,{unClickable:!0,variant:"outline",onClick:y,children:s("close")}),e.jsxs(w,{unClickable:!0,variant:"default",onClick:k,children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),s("download")]})]})]})})]})}function Da(){const{t:a}=_(),[s,t]=c.useState({total:0,data:[]}),[x,g]=c.useState(!1),[u,f]=c.useState(0);async function m(){g(!0);const n=await ca(u);g(!1),n.status?t(n):D.error(a("admin.error"),{description:n.message})}return Z(m,[u]),e.jsxs("div",{className:"redeem-table",children:[s.data&&s.data.length>0||u>0?e.jsxs(e.Fragment,{children:[e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(L,{className:"select-none whitespace-nowrap",children:[e.jsx(r,{children:a("admin.redeem.code")}),e.jsx(r,{children:a("admin.redeem.quota")}),e.jsx(r,{children:a("admin.used")}),e.jsx(r,{children:a("admin.created-at")}),e.jsx(r,{children:a("admin.used-at")}),e.jsx(r,{children:a("admin.action")})]})}),e.jsx(ne,{children:(s.data||[]).map((n,j)=>e.jsxs(L,{className:"whitespace-nowrap",children:[e.jsx(d,{children:n.code}),e.jsx(d,{children:e.jsx(M,{variant:"outline",children:n.quota})}),e.jsx(d,{children:e.jsx(Ce,{state:n.used})}),e.jsx(d,{children:n.created_at}),e.jsx(d,{children:n.updated_at}),e.jsxs(d,{className:"flex gap-2",children:[e.jsx(ue,{size:"icon",variant:"outline",onClick:()=>pe(n.code),children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(Ne,{native:!0,tooltip:a("delete"),variant:"destructive",onClick:async()=>{const o=await ia(n.code);je(a,o,!0),o.status&&await m()},children:e.jsx(he,{className:"h-4 w-4"})})]})]},j))})]}),e.jsx(ie,{current:u,total:s.total,onPageChange:f,offset:!0})]}):x?e.jsx("div",{className:"flex flex-col my-4 items-center",children:e.jsx(R,{className:"w-6 h-6 inline-block animate-spin"})}):e.jsx("p",{className:"empty",children:a("admin.empty")}),e.jsxs("div",{className:"redeem-action",children:[e.jsx("div",{className:"grow"}),e.jsx(w,{variant:"outline",size:"icon",onClick:m,children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(_a,{update:m})]})]})}function Ga(){const{t:a}=_();return e.jsxs("div",{className:X("user-interface",He&&"mobile"),children:[e.jsxs(K,{className:"admin-card",children:[e.jsx(Q,{className:"select-none",children:e.jsx(J,{children:a("admin.user")})}),e.jsx(W,{children:e.jsx(qa,{})})]}),e.jsxs(K,{className:"admin-card",children:[e.jsx(Q,{className:"select-none",children:e.jsxs(J,{className:"flex items-center",children:[a("admin.invitation-manage"),e.jsx(Y,{content:a("admin.invitation-tips"),className:"ml-2 h-6 w-6 translate-y-0.5"})]})}),e.jsx(W,{children:e.jsx(Sa,{})})]}),e.jsxs(K,{className:"admin-card",children:[e.jsx(Q,{className:"select-none",children:e.jsxs(J,{className:"flex items-center",children:[a("admin.invitation"),e.jsx(Y,{content:a("admin.redeem-tips"),className:"ml-2 h-6 w-6 translate-y-0.5"})]})}),e.jsx(W,{children:e.jsx(Da,{})})]})]})}export{Ga as default};
