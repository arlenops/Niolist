import{c as M,b6 as I,u as j,a as z,y as Z,b7 as G,r as u,t as R,j as e,b8 as K,b9 as Q,ba as X,bb as Y,bc as ee,bd as ae,O as se,a5 as g,be as A,bf as te,bg as ne,I as U,bh as L,ac as re,bi as ie,bj as oe,bk as B,bl as le,bm as ce,bn as de,f as me,e as C,bo as pe,aL as F,bp as $,bq as E,br as ue,S as he,m as h,A as xe,h as fe,d as ge,bs as je,bt as ve,aH as ye,aI as ke,bu as we,aJ as be,bv as _,bw as Ne,bx as Ce,J as Me,M as Se}from"./index.59694a49.js";import{A as Pe}from"./arrow-right-left.b733bbed.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M2 9V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-1",key:"fm4g5t"}],["path",{d:"M2 13h10",key:"pgb2dq"}],["path",{d:"m9 16 3-3-3-3",key:"6m91ic"}]],Ee=M("FolderInput",De);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M12.75 7.09a3 3 0 0 1 2.16 2.16",key:"1d4wjd"}],["path",{d:"M17.072 17.072c-1.634 2.17-3.527 3.912-4.471 4.727a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 1.432-4.568",key:"12yil7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.475 2.818A8 8 0 0 1 20 10c0 1.183-.31 2.377-.81 3.533",key:"lhrkcz"}],["path",{d:"M9.13 9.13a3 3 0 0 0 3.74 3.74",key:"13wojd"}]],Ie=M("MapPinOff",_e);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z",key:"irua1i"}],["path",{d:"m5 2 5 5",key:"1lls2c"}],["path",{d:"M2 13h15",key:"1hkzvu"}],["path",{d:"M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z",key:"xk76lq"}]],Ae=M("PaintBucket",ze);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],q=M("Pencil",Le);const V={id:-1,avatar:"1f9d0",name:"",context:[{role:I,content:""}]};function Oe(a,s){switch(s.type){case"update-avatar":return{...a,avatar:s.payload};case"update-name":return{...a,name:s.payload};case"update-description":return{...a,description:s.payload};case"set-conversation":return{...a,context:s.payload};case"new-message":return{...a,context:[...a.context,{role:I,content:""}]};case"new-message-below":return{...a,context:[...a.context.slice(0,s.index+1),{role:I,content:""},...a.context.slice(s.index+1)]};case"update-message-role":return{...a,context:a.context.map((r,o)=>o===s.index?{...r,role:s.payload}:r)};case"update-message-content":return{...a,context:a.context.map((r,o)=>o===s.index?{...r,content:s.payload}:r)};case"change-index":const{from:n,to:i}=s.payload,t=[...a.context],[l]=t.splice(n,1);return t.splice(i,0,l),{...a,context:t};case"remove-message":return{...a,context:a.context.filter((r,o)=>o!==s.index)};case"reset":return{...V};case"set-mask":return{...s.payload};case"import-mask":return{...s.payload,description:s.payload.description||"",id:-1};default:return a}}function Te({role:a,onClick:s}){const n=de(a),i=()=>{const l=(E.indexOf(a)+1)%E.length;s(E[l])};return e.jsx(g,{variant:"outline",size:"icon",className:"shrink-0",onClick:i,children:e.jsx(me,{icon:n,className:"h-4 w-4"})})}function w({children:a,disabled:s,onClick:n}){return e.jsx("div",{className:C("mask-action",s&&"disabled"),onClick:s?void 0:n,children:a})}function He({mask:a,dispatch:s,open:n,onOpenChange:i}){const{t}=j(),l=z(Z),r=z(G),[o,c]=u.useState(!1),[p,x]=u.useState(!1),[v,S]=u.useState(-1),P=R(),D=d=>{S(d),x(!0)},y=async()=>{const d={...a};if(d.context=a.context.filter(f=>f.content.trim().length>0),d.name.trim().length===0||d.context.length===0)return;const m=await pe(d);F(t,m,!0),m.status&&(await $(P),i(!1))};return e.jsx(K,{open:n,onOpenChange:i,children:e.jsx(Q,{children:e.jsxs("div",{className:"mask-drawer-viewport py-4 max-w-[620px] mx-auto",children:[e.jsxs(X,{children:[e.jsx(Y,{className:"text-center mb-4",children:a.id!==-1?t("mask.edit"):t("mask.create")}),e.jsxs(ee,{children:[e.jsx(ae,{value:p?a.context[v].content:"",onChange:d=>s({type:"update-message-content",index:v,payload:d}),open:p,setOpen:x}),e.jsxs("div",{className:"mask-editor-container no-scrollbar max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{className:"mask-editor-row",children:[e.jsxs("div",{className:"mask-editor-column",children:[e.jsx("p",{children:t("mask.avatar")}),e.jsx("div",{className:"grow"}),e.jsx(se,{trigger:e.jsx(g,{variant:"outline",size:"icon",className:"shrink-0",children:e.jsx(A,{emoji:a.avatar,className:"h-6 w-6"})}),open:o,onOpenChange:c,align:"end",classNamePopup:"mask-picker-dialog",notHide:!0,children:e.jsx(te,{className:"picker",height:360,lazyLoadEmojis:!0,skinTonesDisabled:!0,theme:r,open:!0,searchPlaceHolder:t("mask.search-emoji"),getEmojiUrl:ne,onEmojiClick:d=>{c(!1),s({type:"update-avatar",payload:d.unified})}})})]}),e.jsxs("div",{className:"mask-editor-column",children:[e.jsx("p",{children:t("mask.name")}),e.jsx(U,{value:a.name,className:"ml-4",placeholder:t("mask.name-placeholder"),onChange:d=>s({type:"update-name",payload:d.target.value})})]}),e.jsxs("div",{className:"mask-editor-column",children:[e.jsx("p",{children:t("mask.description")}),e.jsx(L,{value:a.description||"",className:"ml-4",placeholder:t("mask.description-placeholder"),onChange:d=>s({type:"update-description",payload:d.target.value})})]})]}),e.jsxs("div",{className:"mask-conversation-list",children:[e.jsx("div",{className:"mask-conversation-title",children:t("mask.conversation")}),a.context.map((d,m)=>e.jsxs("div",{className:"mask-conversation-wrapper",children:[e.jsxs("div",{className:"mask-conversation",children:[e.jsx(Te,{role:d.role,onClick:f=>s({type:"update-message-role",index:m,payload:f})}),e.jsx(L,{className:"ml-4",value:d.content,onChange:f=>s({type:"update-message-content",index:m,payload:f.target.value})})]}),e.jsxs("div",{className:"mask-actions",children:[e.jsx(w,{onClick:()=>s({type:"new-message-below",index:m}),children:e.jsx(re,{})}),e.jsx(w,{onClick:()=>D(m),children:e.jsx(q,{})}),e.jsx(w,{disabled:m===0,onClick:()=>s({type:"change-index",payload:{from:m,to:m-1}}),children:e.jsx(ie,{})}),e.jsx(w,{disabled:m===a.context.length-1,onClick:()=>s({type:"change-index",payload:{from:m,to:m+1}}),children:e.jsx(oe,{})}),e.jsx(w,{disabled:a.context.length===1,onClick:()=>s({type:"remove-message",index:m}),children:e.jsx(B,{})})]})]},m))]})]})]})]}),e.jsxs(le,{children:[e.jsx(g,{unClickable:!0,loading:!0,onClick:y,disabled:!l,children:t(l?"submit":"login-require")}),e.jsx(ce,{asChild:!0,children:e.jsx(g,{unClickable:!0,variant:"outline",children:t("cancel")})})]})]})})})}function Re({width:a=24,height:s=24,x:n=0,y:i=0,cx:t=1,cy:l=1,cr:r=1,className:o,...c}){const p=u.useId();return e.jsxs("svg",{"aria-hidden":"true",className:C("pointer-events-none absolute inset-0 h-full w-full fill-neutral-400/80",o),...c,children:[e.jsx("defs",{children:e.jsx("pattern",{id:p,width:a,height:s,patternUnits:"userSpaceOnUse",patternContentUnits:"userSpaceOnUse",x:n,y:i,children:e.jsx("circle",{id:"pattern-circle",cx:t,cy:l,r})})}),e.jsx("rect",{width:"100%",height:"100%",strokeWidth:0,fill:`url(#${p})`})]})}function Ve(){const{t:a}=j(),s=z(ue),[n,i]=u.useState([]),[t,l]=u.useState(!0);u.useEffect(()=>{(async()=>{try{const k=await Ce();i(k)}catch(k){console.error("Failed to load masks",k)}finally{l(!1)}})()},[]);const[r,o]=u.useState(""),c=u.useMemo(()=>t?[]:O(r,n),[n,r]),p=u.useMemo(()=>t?[]:O(r,s),[s,r]),x=r.length>0&&c.length===0,v=r.length>0&&p.length===0,S=x&&v,P=u.useMemo(()=>{if(t)return[];const N=n.concat(s).reduce((k,W)=>k.concat(W.tags??[]),[]);return Array.from(new Set(N))},[n,s]),[D,y]=u.useState(!1),[d,m]=u.useReducer(Oe,{...V}),f=N=>{m(N),y(!0)},J={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},b={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}};return e.jsxs(he,{className:"relative w-full h-full flex flex-col pr-2 bg-muted/25",children:[e.jsx(Re,{className:"absolute w-full h-full [mask-image:radial-gradient(50vw_circle_at_center,white,transparent)] md:[mask-image:radial-gradient(50vh_circle_at_center,white,transparent)] opacity-80"}),e.jsx(He,{mask:d,dispatch:m,open:D,onOpenChange:y}),e.jsxs(h.div,{initial:"hidden",animate:"visible",variants:J,className:"p-2 pb-8 pt-24",children:[e.jsx(h.div,{variants:b,className:"absolute top-4 left-0 w-full z-10",children:e.jsx(Ue,{tags:P,value:r,onValueChange:o})}),e.jsxs(xe,{children:[!v&&e.jsx(h.div,{variants:b,initial:"hidden",animate:"visible",exit:"hidden",children:e.jsx(T,{title:a("mask.custom"),event:f,masks:p,custom:!0,onCreateClick:()=>{m({type:"reset"}),y(!0)}})}),!x&&e.jsx(h.div,{variants:b,initial:"hidden",animate:"visible",exit:"hidden",children:e.jsx(T,{title:a("mask.system"),event:f,masks:c})})]}),S&&e.jsxs(h.p,{className:"flex flex-row items-center justify-center text-md text-secondary mt-6 mb-4 select-none",variants:b,children:[e.jsx(Ie,{className:"h-4 w-4 mr-1.5"}),a("conversation.empty")]})]})]})}function O(a,s){if(a.trim().length===0)return s;const n=fe(a.toLowerCase(),[" ",",",";","-"]);return s.filter(i=>n.every(t=>i.name.toLowerCase().includes(t.toLowerCase())||(i.tags??[]).some(l=>l.toLowerCase().includes(t))))}function Ue({value:a,onValueChange:s}){const{t:n}=j();return e.jsx("div",{className:"relative w-full flex flex-col items-center justify-center mx-auto py-4 px-6 max-w-[800px]",children:e.jsxs("div",{className:"relative w-full opacity-90 backdrop-blur-sm shadow-md rounded-md",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4"}),e.jsx(U,{className:"pl-10 pr-4 py-2 rounded-md w-full bg-background",placeholder:n("mask.search"),value:a,onChange:i=>s(i.target.value)})]})})}function T({custom:a,title:s,masks:n,event:i,onCreateClick:t}){const{t:l}=j();return e.jsxs("div",{className:"flex container flex-col py-8 pb-2 px-6 mx-auto",children:[e.jsxs("div",{className:"inline-flex flex-row space-x-2 mb-4",children:[e.jsxs("p",{className:"font-bold text-xl flex flex-row items-center",children:[s,e.jsx(je,{variant:"secondary",className:"ml-2 select-none",children:n.length})]}),a&&e.jsxs(g,{size:"default-sm",classNameWrapper:"shrink-0 w-fit",className:"rounded-full ml-2",onClick:t,variant:"outline",children:[e.jsx(Ae,{className:"h-3.5 w-3.5 mr-1.5"}),l("mask.create")]})]}),n&&n.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 animate-fade-in place-content-center justify-items-center content-center",children:n.map((r,o)=>e.jsx(Be,{mask:r,custom:a,event:i,idx:o},o))}):void 0]})}const H=["from-blue-400/25 via-indigo-500/20 to-purple-600/20","from-green-400/20 via-teal-500/20 to-cyan-600/20","from-orange-400/20 via-pink-500/20 to-red-600/20","from-purple-400/20 via-fuchsia-500/20 to-pink-600/20","from-teal-400/20 via-cyan-500/20 to-blue-600/20","from-red-400/20 via-rose-500/20 to-orange-600/20","from-yellow-400/20 via-amber-500/20 to-orange-600/20","from-lime-400/20 via-green-500/20 to-emerald-600/20","from-pink-400/20 via-purple-500/20 to-indigo-600/20","from-emerald-400/20 via-green-500/20 to-lime-600/20","from-fuchsia-400/20 via-pink-500/20 to-rose-600/20","from-sky-400/20 via-blue-500/20 to-indigo-600/20","from-amber-400/20 via-orange-500/20 to-red-600/20","from-violet-400/20 via-purple-500/20 to-fuchsia-600/20","from-cyan-400/20 via-teal-500/20 to-emerald-600/20","from-rose-400/20 via-red-500/20 to-orange-600/20"];function Be({mask:a,idx:s,custom:n,event:i,onClick:t}){const{t:l}=j(),{mask:r}=ve(),o=H[s%H.length],c=()=>{r(a),Me(l("mask.switch-preset"),{description:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"inline-flex flex-row items-center flex-wrap space-x-1",children:[e.jsx(Pe,{className:"w-3 h-3"}),e.jsx("p",{children:l("mask.switch-preset-desc")}),e.jsx(A,{emoji:a.avatar,className:"w-4 h-4"}),e.jsx("p",{className:"font-bold",children:a.name})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:(a.tags??[]).map((p,x)=>e.jsx("span",{className:"tag-item",children:p},x))})]})}),Se.navigate("/"),t==null||t()};return e.jsxs(h.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},whileHover:{scale:1.03,y:-5},whileTap:{scale:.98},onClick:c,className:C("relative flex flex-col w-full group","bg-background transition-all duration-300","rounded-md shadow-sm border cursor-pointer overflow-hidden"),layout:!0,children:[e.jsx(h.div,{className:C("backdrop-blur-sm shadow-sm transition-all rounded-full p-1.5 absolute top-3 right-3","bg-gradient-to-r",o),whileHover:{scale:1.2,rotate:360},transition:{type:"spring",stiffness:300,damping:10},children:e.jsx(A,{className:"w-8 h-8",emoji:a.avatar})}),e.jsxs(h.div,{className:"flex flex-col p-4 pb-3 relative z-10 h-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.05+.2,duration:.3},children:[e.jsxs("h3",{className:"text-base font-semibold mb-0.5 flex items-center",children:[e.jsx(h.span,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:s*.05+.3,duration:.3},children:a.name}),e.jsx(Fe,{mask:a,event:i,custom:n})]}),e.jsx(h.p,{className:"text-xs text-unread",initial:{opacity:0},animate:{opacity:1},transition:{delay:s*.05+.4,duration:.3},children:l("mask.context",{length:a.context.length})}),e.jsx(h.p,{className:"text-xs text-secondary mt-1 line-clamp-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:s*.05+.5,duration:.3},children:a.description}),e.jsx("div",{className:"flex-grow"}),e.jsxs(h.div,{className:"mt-2.5 flex flex-wrap gap-1 ml-auto",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:s*.05+.6,duration:.3},children:[(a.tags??[]).slice(0,3).map((p,x)=>e.jsx(h.span,{className:"tag-item text-xs px-1.5 py-0.5",whileHover:{scale:1.1},whileTap:{scale:.95},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:s*.05+.7+x*.1,duration:.2},children:p},x)),a.tags&&a.tags.length>3&&e.jsxs(h.span,{className:"tag-item text-xs px-1.5 py-0.5",whileHover:{scale:1.1},whileTap:{scale:.95},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:s*.05+1,duration:.2},children:["+",a.tags.length-3]})]})]})]})}function Fe({mask:a,event:s,custom:n}){const{t:i}=j(),t=R(),[l,r]=u.useState(!1),o=c=>{c.preventDefault(),c.stopPropagation()};return e.jsxs(ye,{open:l,onOpenChange:r,children:[e.jsx(ke,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",className:"ml-1.5 p-1 text-primary rounded-full hover:bg-background/80 border w-5 h-5 bg-background/60",onClick:c=>o(c),unClickable:!0,children:e.jsx(we,{className:"h-3 w-3 text-muted-foreground"})})}),e.jsxs(be,{align:"start",children:[n&&e.jsxs(_,{onClick:c=>{o(c),s({type:"set-mask",payload:a}),r(!1)},children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),i("mask.actions.edit")]}),e.jsxs(_,{onClick:c=>{o(c),s({type:"import-mask",payload:a}),r(!1)},children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),i("mask.actions.clone")]}),n&&e.jsxs(_,{onClick:async c=>{o(c);const p=await Ne(a.id);F(i,p,!0),p.status&&(await $(t),r(!1))},children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),i("mask.actions.delete")]})]})]})}export{Re as DotPattern,Ve as default};
