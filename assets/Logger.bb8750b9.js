import{c as C,aq as u,ar as N,u as b,j as e,bR as R,bS as k,bT as E,bV as I,r as l,bG as L,L as T,bL as S,a5 as p,eI as A,e as U,eZ as D,ei as M,aL as O,bk as q}from"./index.59694a49.js";import{P as z}from"./Paragraph.e7cb6a63.js";import"./accordion.31111ca3.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]],F=C("Terminal",B);async function G(){try{return(await u.get("/admin/logger/list")).data||[]}catch(s){return console.warn(s),[]}}async function $(s){try{return(await u.get(`/admin/logger/console?n=${s??100}`)).data.content}catch(a){return console.warn(a),`failed to get info from server: ${N(a)}`}}async function P(s){try{const a=await u.get("/admin/logger/download",{responseType:"blob",params:{path:s}}),n=window.URL.createObjectURL(new Blob([a.data])),t=document.createElement("a");t.href=n,t.setAttribute("download",s),document.body.appendChild(t),t.click()}catch(a){console.warn(a)}}async function V(s){try{return(await u.post(`/admin/logger/delete?path=${s}`)).data}catch(a){return console.warn(a),{status:!1,error:N(a)}}}function W({path:s,size:a,onUpdate:n}){const{t}=b(),o=l.useMemo(()=>D(a),[a]);return e.jsxs("div",{className:"flex items-center justify-between p-3 w-full max-w-full bg-background rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 mb-2",children:[e.jsxs("div",{className:"mr-4",children:[e.jsx("div",{className:"text-sm font-medium text-foreground break-all whitespace-pre-wrap",children:s}),e.jsx("div",{className:"text-xs text-muted-foreground",children:o})]}),e.jsx("div",{className:"grow"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:async()=>P(s),title:t("admin.logger.download"),children:e.jsx(M,{className:"w-4 h-4"})}),e.jsx(p,{variant:"outline",size:"sm",onClick:async()=>{const c=await V(s);c&&n(),O(t,c,!0)},title:t("admin.logger.delete"),children:e.jsx(q,{className:"w-4 h-4 text-destructive"})})]})]})}function _(){const[s,a]=l.useState([]),n=async()=>a(await G());return L(async()=>{await n()},[]),e.jsx("div",{className:"logger-list",children:s.map((t,o)=>l.createElement(W,{...t,key:o,onUpdate:n}))})}function H(){const{t:s}=b(),[a,n]=l.useState(""),[t,o]=l.useState(!1),[c,v]=l.useState(100),f=async()=>{t||(o(!0),n(await $(c)),o(!1))};return L(f,[]),e.jsxs(z,{title:s("admin.logger.console"),className:"logger-container mb-2",isCollapsed:!0,children:[e.jsxs("div",{className:"logger-toolbar",children:[e.jsx(T,{children:s("admin.logger.consoleLength")}),e.jsx(S,{value:c,onValueChange:v,min:1,max:1e3}),e.jsx("div",{className:"grow"}),e.jsx(p,{onClick:f,variant:"outline",size:"icon",children:e.jsx(A,{className:U("w-4 h-4",t&&"animate-spin")})})]}),e.jsxs("div",{className:"logger-console bg-muted/20",children:[e.jsx(F,{className:"w-6 h-6 p-1 bg-primary/80 hover:bg-primary/100 transition duration-300 backdrop-blur-sm text-primary-foreground rounded-sm absolute top-4 right-4"}),e.jsx("pre",{className:"no-scrollbar",style:{fontFamily:"var(--font-family-code) !important"},children:a.split(`
`).map((i,j)=>{const x=i.match(/^\[(DEBUG|INFO|WARN|ERROR|CRITICAL)\]/),w=i.match(/\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/),d=i.match(/\b\d+(\.\d+)?\b/g);let m=i;if(x){const r=x[1],g={DEBUG:"text-gray-500",INFO:"text-blue-500",WARN:"text-yellow-500",ERROR:"text-red-500",CRITICAL:"text-purple-700 font-bold"}[r]||"";return m=m.replace(x[0],""),e.jsxs("span",{children:[e.jsxs("span",{className:g,children:["[",r,"]"]}),w&&e.jsxs("span",{className:"font-thin",children:[" ",w[0]]}),m.split(/((?:\b\d+(?:\.\d+)?\b))/).map((h,y)=>d&&d.includes(h)?e.jsx("span",{className:"font-semibold",children:h},y):e.jsx("span",{children:h},y)),`
`]},j)}return e.jsxs("span",{children:[m.split(/((?:\b\d+(?:\.\d+)?\b))/).map((r,g)=>d&&d.includes(r)?e.jsx("span",{className:"font-semibold",children:r},g):e.jsx("span",{children:r},g)),`
`]},j)})})]})]})}function Q(){const{t:s}=b();return e.jsx("div",{className:"logger",children:e.jsxs(R,{className:"admin-card logger-card",children:[e.jsx(k,{className:"select-none",children:e.jsx(E,{children:s("admin.logger.title")})}),e.jsxs(I,{children:[e.jsx(H,{}),e.jsx(_,{})]})]})})}export{Q as default};
