import{c as M,j as e,a5 as n,M as P,cJ as T,u,bR as J,bS as L,bT as W,bV as q,t as z,a as v,cZ as E,g as G,r as c,c4 as k,c_ as A,c$ as H,G as V,e as _,L as I,d0 as C,cN as O,ap as R,cP as Z,d1 as B,W as D,cI as Q,cG as K,cH as U,J as S}from"./index.59694a49.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]],Y=M("Files",X);function ee({current:a,total:t,quota:l}){const{t:i}=u();return e.jsxs("div",{className:"article-progress w-full mb-4",children:[e.jsx("p",{className:"select-none mt-4 mb-2.5 flex flex-row items-center content-center w-full justify-center text-center",children:t!==0&&a===t?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-5 w-5 mr-2 inline-block animate-out shrink-0"}),i("article.generate-success")]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-5 w-5 mr-2 inline-block animate-spin shrink-0"}),i("article.progress-title",{current:a,total:t})]})}),e.jsx(B,{value:100*a/t}),e.jsxs("div",{className:"article-quota flex flex-row mt-4 border border-input rounded-md py-1 px-3 select-none w-max items-center mx-auto",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),e.jsx("p",{children:l.toFixed(2)})]})]})}function ae(){const{t:a}=u(),t=z(),l=v(E),i=v(G),[x,p]=c.useState(""),[d,j]=c.useState(""),[f,m]=c.useState(!1),[y,g]=c.useState({current:0,total:0}),[w,b]=c.useState(0),[h,N]=c.useState("");function F(){p(""),j(""),N(""),m(!1),b(0),g({current:0,total:0})}function $(){m(!0);const s=new WebSocket(`${Q}/article/create`);s.onopen=()=>{s.send(JSON.stringify({token:K(U),web:l,title:d,prompt:x,model:i}))},s.onmessage=o=>{const r=JSON.parse(o.data);r.data&&r.data.quota&&b(w+r.data.quota),r.hash?(S.success(a("article.generate-success"),{description:a("article.generate-success-prompt")}),N(r.hash)):g(r.data)},s.onerror=o=>{console.debug(`[article] error during generation: ${o}`),S.error(a("article.generate-failed"),{description:`${a("article.generate-failed-prompt")} (${o.toString()})`}),m(!1),s.close()}}return f?e.jsxs(e.Fragment,{children:[e.jsx(ee,{...y,quota:w}),h&&e.jsxs("div",{className:"article-action flex flex-row items-center my-4 gap-4",children:[e.jsxs(n,{variant:"outline",className:"w-full whitespace-nowrap",onClick:()=>{location.href=`${k}/article/download/zip?hash=${h}`},children:[" ",a("article.download-format",{name:"zip"})," "]}),e.jsxs(n,{variant:"outline",className:"w-full whitespace-nowrap",onClick:()=>{location.href=`${k}/article/download/tar?hash=${h}`},children:[" ",a("article.download-format",{name:"tar"})," "]})]}),e.jsx(n,{variant:"default",className:"mt-5 w-full mx-auto",onClick:F,children:a("close")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row items-center mx-auto",children:[e.jsx(A,{"aria-label":a("chat.web-aria"),defaultPressed:!1,onPressedChange:s=>t(H(s)),variant:"outline",children:e.jsx(V,{className:_("h-4 w-4 web",l&&"enable")})}),e.jsx(I,{className:"ml-2.5 whitespace-nowrap",children:a("article.web-checkbox")})]}),e.jsx(C,{placeholder:a("article.prompt-placeholder"),rows:3,value:x,onChange:s=>p(s.target.value)}),e.jsx(C,{placeholder:a("article.input-placeholder"),rows:8,value:d,onChange:s=>j(s.target.value)}),e.jsx(O,{side:"bottom"}),e.jsx(n,{variant:"default",className:"mt-5 w-full mx-auto",onClick:$,disabled:f||!d,children:a("article.generate")})]})}function se(){const{t:a}=u();return e.jsxs(J,{className:"article-wrapper",children:[e.jsx(L,{className:"py-4",children:e.jsxs(W,{className:"article-title",children:[e.jsx(Y,{className:"h-5 w-5 mr-2"}),a("article.title")]})}),e.jsx(q,{className:"article-content",children:e.jsx(ae,{})})]})}function re(){return e.jsx("div",{className:"article-page",children:e.jsxs("div",{className:"article-container",children:[e.jsx(n,{className:"action",variant:"ghost",size:"icon",onClick:()=>P.navigate("/"),children:e.jsx(T,{className:"h-5 w-5 back"})}),e.jsx(se,{})]})})}export{re as default};
